{"id":4360,"date":"2014-03-24T00:47:37","date_gmt":"2014-03-24T00:47:37","guid":{"rendered":"https:\/\/mohamedradwan.com\/?p=4360"},"modified":"2016-05-24T05:40:37","modified_gmt":"2016-05-24T05:40:37","slug":"understanding-action-for-state-transation-in-details","status":"publish","type":"post","link":"https:\/\/mohamedradwan.com\/2014\/03\/24\/understanding-action-for-state-transation-in-details\/","title":{"rendered":"Understanding Action for state transition in Details"},"content":{"rendered":"<p>In this blog series I will explain\u00a0<strong>TFS Process Customization<\/strong>\u00a0in details, I will try to explain what happen behind the scene, show common errors that happen when we perform customization and answer many questions that could come for anyone perform TFS Process Customization, this series consist of following parts:<\/p>\n<ul>\n<li><a title=\"Part 1 - Working with Fields\" href=\"https:\/\/mohamedradwan.com\/2014\/02\/16\/understanding-tfs-process-customization-in-details-series\/\" target=\"_blank\">Part 1 &#8211; Working with Fields<\/a><\/li>\n<li><a title=\"Part 2 \u2013 Prepare SharePoint for the new system.\" href=\"https:\/\/mohamedradwan.com\/2014\/03\/24\/understanding-action-for-state-transation-in-details\/\" target=\"_blank\">Part 2 \u2013Understanding Action for state transition in Details<\/a><\/li>\n<li><a title=\"Part 3 \u2013 Prepare the new machine and install SQL Server.\" href=\"#\" target=\"_blank\">Part 3 \u2013\u00a0<\/a><a title=\"Part 2 \u2013 Prepare SharePoint for the new system.\" href=\"https:\/\/mohamedradwan.com\/2013\/01\/05\/upgrade-tfs-2010-to-tfs-2012-with-migration-to-a-new-hardware-part-2-prepare-sharepoint-for-the-new-system\/\" target=\"_blank\">Place Holder 2<\/a><\/li>\n<li><a title=\"Part 4 - Install TFS 2012 Update 1 &amp; Backup DBs and Reporting Key.\" href=\"#\" target=\"_blank\">Part 4 &#8211;\u00a0<\/a><a title=\"Part 2 \u2013 Prepare SharePoint for the new system.\" href=\"https:\/\/mohamedradwan.com\/2013\/01\/05\/upgrade-tfs-2010-to-tfs-2012-with-migration-to-a-new-hardware-part-2-prepare-sharepoint-for-the-new-system\/\" target=\"_blank\">Place Holder 3<\/a><\/li>\n<li><a title=\"Part 5 \u2013 Restore DBs and Reporting Encryption Key.\" href=\"#\" target=\"_blank\">Part 5 \u2013\u00a0<\/a><a title=\"Part 2 \u2013 Prepare SharePoint for the new system.\" href=\"https:\/\/mohamedradwan.com\/2013\/01\/05\/upgrade-tfs-2010-to-tfs-2012-with-migration-to-a-new-hardware-part-2-prepare-sharepoint-for-the-new-system\/\" target=\"_blank\">Place Holder 4<\/a><\/li>\n<li><a title=\"Part 6 - Configure TFS 2012.\" href=\"#\" target=\"_blank\">Part 6 &#8211;\u00a0<\/a><a title=\"Part 2 \u2013 Prepare SharePoint for the new system.\" href=\"https:\/\/mohamedradwan.com\/2013\/01\/05\/upgrade-tfs-2010-to-tfs-2012-with-migration-to-a-new-hardware-part-2-prepare-sharepoint-for-the-new-system\/\" target=\"_blank\">Place Holder 5<\/a><\/li>\n<\/ul>\n<p>Each part consist of one or many sections as needed.<\/p>\n<p>=================================================================================<\/p>\n<h3><span style=\"color:#339966;\">Part 2 &#8211;\u00a0Understanding Action for state transition in Details<\/span><\/h3>\n<p>[youtube=http:\/\/youtu.be\/3eqXzAJ0ri4 ]<br \/>\nAction is a very confused concept for many people, what is action? Can I create a custom action? How to use action or custom action?<\/p>\n<p>So in this post I will try to simplify what is really meaning by Action and how does it work?<\/p>\n<p><span style=\"color:#339966;\">So the first question is: what is Action?<\/span><\/p>\n<p>It&#8217;s just a unique string that used as a flag that added in the transition between states to be used by third party tools, so we can know which is the current state and which is the next state for given action in a work-item.<\/p>\n<p>Just imagine that I have create a small application that has only one button that list some work-items from different types of work-items (Bug, Task, Change Request, Etc)<\/p>\n<p><a href=\"https:\/\/mohamedradwan.com\/2014\/03\/24\/understanding-action-for-state-transation-in-details\/change-sate-based-on-action-transation\/#main\" rel=\"attachment wp-att-4374\"><img loading=\"lazy\" decoding=\"async\" class=\"alignnone size-full wp-image-4374\" src=\"https:\/\/mohamedradwan.com\/wp-content\/uploads\/2014\/03\/change-sate-based-on-action-transation.png\" alt=\"Change Sate based on action transation\" width=\"301\" height=\"300\" srcset=\"https:\/\/mohamedradwan.com\/wp-content\/uploads\/2014\/03\/change-sate-based-on-action-transation.png 301w, https:\/\/mohamedradwan.com\/wp-content\/uploads\/2014\/03\/change-sate-based-on-action-transation-150x150.png 150w, https:\/\/mohamedradwan.com\/wp-content\/uploads\/2014\/03\/change-sate-based-on-action-transation-300x299.png 300w\" sizes=\"(max-width: 301px) 100vw, 301px\" \/><\/a><\/p>\n<p>I just want when I click on the button all work-items from <strong>Type-1<\/strong> changed from <strong>Sate-1 to State-2<\/strong> but if the work-items in <strong>State-2 or\u00a0<strong>State-3, <\/strong><\/strong>it remains in the same state.<\/p>\n<p>I also need all work-items from <strong>Type-2<\/strong> changed from\u00a0<strong>Sate-2 to State-3\u00a0<\/strong>but if the work-items in<strong>\u00a0State-1 or\u00a0State-3, <\/strong>\u00a0it remains in the same state &#8230;&#8230;&#8230;.. to do that I need to go to the WID (<strong>Work Item Definition<\/strong>) for these 2 types of work-items and in the transition between the desired states\u00a0I will put my custom action, and this action can be retrieved by TFS SDK afterwards.<\/p>\n<p><span style=\"color:#339966;\"><strong>Work-item type 1<\/strong><\/span><\/p>\n<p>[code language=&#8221;xml&#8221;]<br \/>\n&lt;TRANSITION from=&quot;State-1&quot; to=&quot;State-2&quot;&gt;<\/p>\n<p>&lt;ACTIONS&gt;<\/p>\n<p>&lt;ACTION value=&quot;Radwan.Actions.CustomAction&quot;&gt;<\/p>\n<p>&lt;\/ACTIONS&gt;<\/p>\n<p>&lt;\/TRANSITION&gt;<br \/>\n[\/code]<\/p>\n<p><span style=\"color:#339966;\"><strong>Work-item type 2<\/strong><\/span><\/p>\n<p>[code language=&#8221;xml&#8221;]<br \/>\n&lt;TRANSITION from=&quot;State-2&quot; to=&quot;State-3&quot;&gt;<\/p>\n<p>&lt;ACTIONS&gt;<\/p>\n<p>&lt;ACTION value=&quot;Radwan.Actions.CustomAction&quot;&gt;<\/p>\n<p>&lt;\/ACTIONS&gt;<\/p>\n<p>&lt;\/TRANSITION&gt;<br \/>\n[\/code]<\/p>\n<p><span style=\"color:#339966;\"><strong>Work-item type 1<\/strong><\/span><br \/>\n<a href=\"https:\/\/mohamedradwan.com\/2014\/03\/24\/understanding-action-for-state-transation-in-details\/action\/#main\" rel=\"attachment wp-att-4372\"><img loading=\"lazy\" decoding=\"async\" class=\"alignnone size-large wp-image-4372\" src=\"https:\/\/mohamedradwan.com\/wp-content\/uploads\/2014\/03\/action.jpg?w=660\" alt=\"Action\" width=\"660\" height=\"246\" srcset=\"https:\/\/mohamedradwan.com\/wp-content\/uploads\/2014\/03\/action.jpg 949w, https:\/\/mohamedradwan.com\/wp-content\/uploads\/2014\/03\/action-300x112-1.jpg 300w, https:\/\/mohamedradwan.com\/wp-content\/uploads\/2014\/03\/action-768x286-1.jpg 768w\" sizes=\"(max-width: 660px) 100vw, 660px\" \/><br \/>\n<\/a><span style=\"color:#339966;\"><strong>Work-item type 2<\/strong><\/span><\/p>\n<p><a href=\"https:\/\/mohamedradwan.com\/2014\/03\/24\/understanding-action-for-state-transation-in-details\/action-2\/#main\" rel=\"attachment wp-att-4388\"><img loading=\"lazy\" decoding=\"async\" class=\"alignnone size-large wp-image-4388\" src=\"https:\/\/mohamedradwan.com\/wp-content\/uploads\/2014\/03\/action-2.jpg?w=660\" alt=\"Action-2\" width=\"660\" height=\"246\" srcset=\"https:\/\/mohamedradwan.com\/wp-content\/uploads\/2014\/03\/action-2.jpg 949w, https:\/\/mohamedradwan.com\/wp-content\/uploads\/2014\/03\/action-2-300x112-1.jpg 300w, https:\/\/mohamedradwan.com\/wp-content\/uploads\/2014\/03\/action-2-768x286-1.jpg 768w\" sizes=\"(max-width: 660px) 100vw, 660px\" \/><\/a><a href=\"https:\/\/mohamedradwan.com\/2014\/03\/24\/understanding-action-for-state-transation-in-details\/action\/#main\" rel=\"attachment wp-att-4372\"><br \/>\n<\/a>So when I get next state using TFS API or (SDK) with this custom action I can know which work-item in the desired state so I can advance it to the next state and if the work-item doesn&#8217;t has the action in the transition, that&#8217;s meaning I don&#8217;t need to advance its state.<\/p>\n<p>The following code get some work-items and iterate over them and get next state for my custom action and print next state if it found that action.<\/p>\n<p>[sourcecode language=&#8221;csharp&#8221;]<br \/>\nWorkItemCollection witCollection = workItemStore.Query(wiqlQuery);<br \/>\n foreach (WorkItem workItem in witCollection)<br \/>\n {<\/p>\n<p> Console.WriteLine(&quot;Next State for {0} is {1}&quot;, workItem.Title,<br \/>\n workItem.GetNextState(&quot;Radwan.Actions.CustomAction&quot;));<\/p>\n<p> }<br \/>\n[\/sourcecode]<\/p>\n<p>This will told me if my flag (Custom Action) is there or not and what is the next state so I can advance (change) the state.<\/p>\n<p>[sourcecode language=&#8221;csharp&#8221;]<br \/>\nclass Program<br \/>\n {<br \/>\n static void Main(string[] args)<br \/>\n {<br \/>\n RetrieveWorkItems();<br \/>\n Console.Read();<br \/>\n }<br \/>\n public static void RetrieveWorkItems()<br \/>\n {<br \/>\n var tfs = TfsTeamProjectCollectionFactory.GetTeamProjectCollection(new<br \/>\n Uri(&quot;http:\/\/VSALM:8080\/TFS\/Collection&quot;));<br \/>\n var workItemStore = tfs.GetService&lt;WorkItemStore&gt;();<\/p>\n<p>var wiqlQuery = String.Format(@&quot;Select [State], [Title] From<br \/>\n WorkItems Where [Work Item Type] = &#8216;Task&#8217; Order By [State] Asc,<br \/>\n [Changed Date] Desc&quot;); ;<\/p>\n<p>WorkItemCollection witCollection = workItemStore.Query(wiqlQuery);<br \/>\n foreach (WorkItem workItem in witCollection)<br \/>\n {<br \/>\n Console.WriteLine(&quot;ID: {0}&quot;, workItem.Id);<br \/>\n Console.WriteLine(&quot;Title: {0}&quot;, workItem.Title);<br \/>\n Console.WriteLine(&quot;Next State for {0} is {1}&quot;, workItem.Title, workItem.GetNextState(&quot;Microsoft.VSTS.Actions.Checkin&quot;));<br \/>\n Console.WriteLine(&quot;Next State for {0} is {1}&quot;, workItem.Title, workItem.GetNextState(&quot;Radwan.Actions.CustomAction&quot;));<br \/>\n Console.WriteLine(&quot;&quot;);<br \/>\n }<br \/>\n }<br \/>\n }<\/p>\n<p>[\/sourcecode]<\/p>\n<p><a href=\"http:\/\/msdn.microsoft.com\/en-us\/library\/ms194990.aspx\" target=\"_blank\">Automate field assignments based on State, Transition, or Reason<\/a><br \/>\n<a href=\"http:\/\/social.msdn.microsoft.com\/Forums\/vstudio\/pt-BR\/4f40db2f-3440-4965-884d-dd915fdc03bc\/work-item-action-list?forum=tfsworkitemtracking\" target=\"_blank\">Work item Action lis<\/a>t<\/p>\n<p><a href=\"http:\/\/social.msdn.microsoft.com\/Forums\/vstudio\/en-US\/48a70325-d2b6-4e53-b1c5-8d08f68fb34b\/obtain-possible-next-states-of-a-work-item-programatically?forum=tfsworkitemtracking\" target=\"_blank\">Obtain possible next states of a work item programatically?<\/a><\/p>\n<p><a href=\"http:\/\/social.msdn.microsoft.com\/Forums\/vstudio\/en-US\/0ce431bc-a8ee-44b1-9388-ca82bc2d9689\/changing-state-according-to-a-fields-value?forum=tfsworkitemtracking\" target=\"_blank\">Changing State according to a field&#8217;s value<\/a><\/p>\n<p><a href=\"http:\/\/blogs.msdn.com\/b\/visualstudioalm\/archive\/2012\/03\/06\/get-your-agile-project-fixed-after-an-upgrade-from-tfs2010-to-tfs11-beta.aspx\" target=\"_blank\">New State for TFS 2012<\/a><\/p>\n<p><a href=\"http:\/\/msdn.microsoft.com\/en-us\/library\/microsoft.teamfoundation.workitemtracking.client.workitem.getnextstate.aspx\" target=\"_blank\">WorkItem.GetNextState Method<\/a><\/p>\n<p>&nbsp;<\/p>\n","protected":false},"excerpt":{"rendered":"<p>In this blog series I will explain\u00a0TFS Process Customization\u00a0in details, &hellip;<\/p>\n<p class=\"read-more\"> <a class=\"ast-button\" href=\"https:\/\/mohamedradwan.com\/2014\/03\/24\/understanding-action-for-state-transation-in-details\/\"> <span class=\"screen-reader-text\">Understanding Action for state transition in Details<\/span> Read More<\/a><\/p>\n","protected":false},"author":1,"featured_media":0,"comment_status":"open","ping_status":"open","sticky":false,"template":"","format":"standard","meta":{"site-sidebar-layout":"default","site-content-layout":"default","ast-global-header-display":"","ast-banner-title-visibility":"","ast-main-header-display":"","ast-hfb-above-header-display":"","ast-hfb-below-header-display":"","ast-hfb-mobile-header-display":"","site-post-title":"","ast-breadcrumbs-content":"","ast-featured-img":"","footer-sml-layout":"","theme-transparent-header-meta":"","adv-header-id-meta":"","stick-header-meta":"","header-above-stick-meta":"","header-main-stick-meta":"","header-below-stick-meta":"","footnotes":""},"categories":[16,43],"tags":[],"_links":{"self":[{"href":"https:\/\/mohamedradwan.com\/wp-json\/wp\/v2\/posts\/4360"}],"collection":[{"href":"https:\/\/mohamedradwan.com\/wp-json\/wp\/v2\/posts"}],"about":[{"href":"https:\/\/mohamedradwan.com\/wp-json\/wp\/v2\/types\/post"}],"author":[{"embeddable":true,"href":"https:\/\/mohamedradwan.com\/wp-json\/wp\/v2\/users\/1"}],"replies":[{"embeddable":true,"href":"https:\/\/mohamedradwan.com\/wp-json\/wp\/v2\/comments?post=4360"}],"version-history":[{"count":2,"href":"https:\/\/mohamedradwan.com\/wp-json\/wp\/v2\/posts\/4360\/revisions"}],"predecessor-version":[{"id":5987,"href":"https:\/\/mohamedradwan.com\/wp-json\/wp\/v2\/posts\/4360\/revisions\/5987"}],"wp:attachment":[{"href":"https:\/\/mohamedradwan.com\/wp-json\/wp\/v2\/media?parent=4360"}],"wp:term":[{"taxonomy":"category","embeddable":true,"href":"https:\/\/mohamedradwan.com\/wp-json\/wp\/v2\/categories?post=4360"},{"taxonomy":"post_tag","embeddable":true,"href":"https:\/\/mohamedradwan.com\/wp-json\/wp\/v2\/tags?post=4360"}],"curies":[{"name":"wp","href":"https:\/\/api.w.org\/{rel}","templated":true}]}}