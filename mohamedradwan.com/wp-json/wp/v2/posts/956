{"id":956,"date":"2011-10-17T00:46:56","date_gmt":"2011-10-17T00:46:56","guid":{"rendered":"https:\/\/mohamedradwan.com\/?p=956"},"modified":"2011-10-17T00:46:56","modified_gmt":"2011-10-17T00:46:56","slug":"extension-methods-to-ienumerable-of-t-and-custom-collection","status":"publish","type":"post","link":"https:\/\/mohamedradwan.com\/2011\/10\/17\/extension-methods-to-ienumerable-of-t-and-custom-collection\/","title":{"rendered":"Extension Methods for IEnumerable of T and Custom Collection"},"content":{"rendered":"<hr\/>\n<p>Custom Collection one of the best design pattern I have ever used. It encapsulates items or array of items\u00a0inside a seperate class which will allow us to \u00a0full\u00a0control these items, but for\u00a0modern\u00a0development, it&#8217;s\u00a0rarely\u00a0to see custom collection in any post or code snippet everywhere, when I deeply search why the community didn&#8217;t follow this pattern, I found the community not only follow this pattern, no it&#8217;s recommended to not doing it, Microsoft .NET Framework Design Guide<\/p>\n<p><a title=\"MS Design Guidance\" href=\"http:\/\/msdn.microsoft.com\/en-us\/library\/ms229042.aspx\" target=\"_blank\">http:\/\/msdn.microsoft.com\/en-us\/library\/ms229042.aspx<\/a><\/p>\n<p><a title=\"Stack Overflow \" href=\"http:\/\/stackoverflow.com\/questions\/1544800\/custom-collection-vs-generic-collection-for-public-methods\" target=\"_blank\">http:\/\/stackoverflow.com\/questions\/1544800\/custom-collection-vs-generic-collection-for-public-methods<\/a><\/p>\n<p>So what is the main reason for that?<\/p>\n<p>The answer is\u00a0<strong>Extension\u00a0Method<\/strong>, Microsoft extend all the Old collection like (Any Array,\u00a0List&lt;T&gt;, Queue&lt;T&gt;, Stack&lt;T&gt;, Dictionary&lt;T,T&gt; etc.) with all\u00a0extension\u00a0methods exist in the System.LINQ, so no need to create custom collection, we just need to use IEnumerable&lt;T&gt; or IList&lt;T&gt; and then extend them at any time in my project with new\u00a0extension\u00a0methods, but be careful this will not break the access of the\u00a0members, in other words the extension method will not be able to access the private member like in the custom collection does, but in most\u00a0cases\u00a0this will be good enough<\/p>\n<ul>\n<li>Extension Method for <span style=\"color:#339966;\">IEnumerable<\/span>&lt;T&gt;<\/li>\n<\/ul>\n<div>\n<p>We can create extension methods that apply to an interface, which allow us to call this method for each class that implement this interface, for example<\/p>\n<p>If we add\u00a0extension\u00a0method called CalculateSalary for <span style=\"color:#339966;\">IEnumerable<\/span>&lt;<span style=\"color:#339966;\">Employee<\/span>&gt; as the following:<\/p>\n<p>[sourcecode language=&#8221;csharp&#8221;]<br \/>\npublic\u00a0static\u00a0decimal\u00a0CalculateSalary(this\u00a0IEnumerable&lt;Employee&gt;\u00a0empList)<br \/>\n{<br \/>\n           decimal\u00a0totalSalary\u00a0=\u00a00m;<br \/>\n           foreach\u00a0(var\u00a0employee\u00a0in\u00a0empList)<br \/>\n            {<br \/>\n              totalSalary\u00a0+=\u00a0employee.Salary;<br \/>\n            }<br \/>\n           return\u00a0totalSalary;<br \/>\n        }<br \/>\n[\/sourcecode]<\/p>\n<p>So now I can create list of Employee and I will find the method exist in this list as the following:<\/p>\n<p>[sourcecode language=&#8221;csharp&#8221;]<br \/>\nstatic\u00a0void\u00a0Main(string[]\u00a0args)<br \/>\n{<br \/>\n      IEnumerable&lt;Employee&gt;\u00a0emplloyees\u00a0=\u00a0new\u00a0List&lt;Employee&gt;<br \/>\n       {<br \/>\n          new\u00a0Employee\u00a0{\u00a0Id\u00a0=\u00a01,\u00a0Salary\u00a0=\u00a049m\u00a0},<br \/>\n          new\u00a0Employee\u00a0{\u00a0Id\u00a0=\u00a02,\u00a0Salary\u00a0=\u00a033m\u00a0},<br \/>\n          new\u00a0Employee\u00a0{\u00a0Id\u00a0=\u00a04,\u00a0Salary\u00a0=\u00a066m\u00a0}<br \/>\n       };<\/p>\n<p>      Console.WriteLine(emplloyees.CalculateSalary());<\/p>\n<p>      Console.ReadLine();<br \/>\n}<br \/>\n[\/sourcecode]<\/p>\n<p>Extension Method rules<\/p>\n<ul>\n<li>It must be static and exist in any static class<\/li>\n<li>It will extend the first parameter which is prefix with this<\/li>\n<li>It will pass current instance of the extended class at the run time<\/li>\n<li>If you extend an Interface that&#8217;s meaning you extend any class implement that interface<\/li>\n<\/ul>\n<pre><\/pre>\n<\/div>\n","protected":false},"excerpt":{"rendered":"<p>Custom Collection one of the best design pattern I have &hellip;<\/p>\n<p class=\"read-more\"> <a class=\"ast-button\" href=\"https:\/\/mohamedradwan.com\/2011\/10\/17\/extension-methods-to-ienumerable-of-t-and-custom-collection\/\"> <span class=\"screen-reader-text\">Extension Methods for IEnumerable of T and Custom Collection<\/span> Read More<\/a><\/p>\n","protected":false},"author":2,"featured_media":0,"comment_status":"open","ping_status":"open","sticky":false,"template":"","format":"standard","meta":{"site-sidebar-layout":"default","site-content-layout":"default","ast-global-header-display":"","ast-banner-title-visibility":"","ast-main-header-display":"","ast-hfb-above-header-display":"","ast-hfb-below-header-display":"","ast-hfb-mobile-header-display":"","site-post-title":"","ast-breadcrumbs-content":"","ast-featured-img":"","footer-sml-layout":"","theme-transparent-header-meta":"","adv-header-id-meta":"","stick-header-meta":"","header-above-stick-meta":"","header-main-stick-meta":"","header-below-stick-meta":"","footnotes":""},"categories":[16,19,47],"tags":[],"_links":{"self":[{"href":"https:\/\/mohamedradwan.com\/wp-json\/wp\/v2\/posts\/956"}],"collection":[{"href":"https:\/\/mohamedradwan.com\/wp-json\/wp\/v2\/posts"}],"about":[{"href":"https:\/\/mohamedradwan.com\/wp-json\/wp\/v2\/types\/post"}],"author":[{"embeddable":true,"href":"https:\/\/mohamedradwan.com\/wp-json\/wp\/v2\/users\/2"}],"replies":[{"embeddable":true,"href":"https:\/\/mohamedradwan.com\/wp-json\/wp\/v2\/comments?post=956"}],"version-history":[{"count":0,"href":"https:\/\/mohamedradwan.com\/wp-json\/wp\/v2\/posts\/956\/revisions"}],"wp:attachment":[{"href":"https:\/\/mohamedradwan.com\/wp-json\/wp\/v2\/media?parent=956"}],"wp:term":[{"taxonomy":"category","embeddable":true,"href":"https:\/\/mohamedradwan.com\/wp-json\/wp\/v2\/categories?post=956"},{"taxonomy":"post_tag","embeddable":true,"href":"https:\/\/mohamedradwan.com\/wp-json\/wp\/v2\/tags?post=956"}],"curies":[{"name":"wp","href":"https:\/\/api.w.org\/{rel}","templated":true}]}}