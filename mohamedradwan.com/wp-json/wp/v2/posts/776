{"id":776,"date":"2011-07-21T21:44:51","date_gmt":"2011-07-21T21:44:51","guid":{"rendered":"https:\/\/mohamedradwan.com\/?p=776"},"modified":"2017-08-23T01:53:10","modified_gmt":"2017-08-23T01:53:10","slug":"how-to-isolate-layers-and-other-library-using-moles-in-unit-testing","status":"publish","type":"post","link":"https:\/\/mohamedradwan.com\/2011\/07\/21\/how-to-isolate-layers-and-other-library-using-moles-in-unit-testing\/","title":{"rendered":"How to isolate layers and other library using Moles in Unit Testing?"},"content":{"rendered":"<hr \/>\n<p>Moles is one of the Mocking framework for isolation dependencies and other layer&#8217;s classes, I used to work with Moq framework and it was very good, but with Mole you can do very good things I don&#8217;t know if we can make it with Moq? \u00a0like you can isolate your code from .NET Framework code for example how you will isolate DateTime.Now to return\u00a0specific\u00a0value that you want? \u00a0Remember that you don&#8217;t have access\u00a0definition\u00a0to the .NET Framework Classes, but with Moles you can do that.<\/p>\n<p>I create a solution from\u00a0multiple\u00a0projects so we can\u00a0investigate\u00a0Moles, the solution structure as the following:<\/p>\n<p><img loading=\"lazy\" decoding=\"async\" class=\"alignnone size-full wp-image-7119\" src=\"https:\/\/mohamedradwan.com\/wp-content\/uploads\/2011\/07\/7-21-2011-5-13-39-PM.png\" alt=\"7-21-2011 5-13-39 PM\" width=\"296\" height=\"279\" \/><\/p>\n<p><img loading=\"lazy\" decoding=\"async\" class=\"alignnone size-full wp-image-7120\" src=\"https:\/\/mohamedradwan.com\/wp-content\/uploads\/2011\/07\/7-21-2011-5-13-58-PM.png\" alt=\"7-21-2011 5-13-58 PM\" width=\"297\" height=\"471\" srcset=\"https:\/\/mohamedradwan.com\/wp-content\/uploads\/2011\/07\/7-21-2011-5-13-58-PM.png 297w, https:\/\/mohamedradwan.com\/wp-content\/uploads\/2011\/07\/7-21-2011-5-13-58-PM-189x300.png 189w\" sizes=\"(max-width: 297px) 100vw, 297px\" \/><\/p>\n<p>&nbsp;<\/p>\n<p>You will add\u00a0reference\u00a0in the Test project to the DB project<\/p>\n<p>Right click on the DB ref and choose Add Mole Assembly<\/p>\n<p><img loading=\"lazy\" decoding=\"async\" class=\"alignnone size-full wp-image-7124\" src=\"https:\/\/mohamedradwan.com\/wp-content\/uploads\/2011\/07\/7-21-2011-5-16-27-PM.png\" alt=\"7-21-2011 5-16-27 PM\" width=\"883\" height=\"576\" srcset=\"https:\/\/mohamedradwan.com\/wp-content\/uploads\/2011\/07\/7-21-2011-5-16-27-PM.png 883w, https:\/\/mohamedradwan.com\/wp-content\/uploads\/2011\/07\/7-21-2011-5-16-27-PM-300x196.png 300w, https:\/\/mohamedradwan.com\/wp-content\/uploads\/2011\/07\/7-21-2011-5-16-27-PM-768x501.png 768w\" sizes=\"(max-width: 883px) 100vw, 883px\" \/><\/p>\n<p><img loading=\"lazy\" decoding=\"async\" class=\"alignnone size-full wp-image-7125\" src=\"https:\/\/mohamedradwan.com\/wp-content\/uploads\/2011\/07\/7-21-2011-6-05-42-PM.png\" alt=\"7-21-2011 6-05-42 PM\" width=\"626\" height=\"575\" srcset=\"https:\/\/mohamedradwan.com\/wp-content\/uploads\/2011\/07\/7-21-2011-6-05-42-PM.png 626w, https:\/\/mohamedradwan.com\/wp-content\/uploads\/2011\/07\/7-21-2011-6-05-42-PM-300x276.png 300w\" sizes=\"(max-width: 626px) 100vw, 626px\" \/><\/p>\n<p>Start using it as the following<\/p>\n<p>DB Class<\/p>\n<p>[sourcecode language=&#8221;csharp&#8221;]<br \/>\nusing\u00a0Common;<br \/>\nnamespace\u00a0DB<br \/>\n{<br \/>\npublic\u00a0class\u00a0DataBase:IDataBase<br \/>\n{<br \/>\npublic\u00a0bool\u00a0Save(IEmployee\u00a0e)<br \/>\n{<br \/>\nreturn\u00a0true;<br \/>\n}<br \/>\n}<br \/>\n}<br \/>\n[\/sourcecode]<\/p>\n<p>Employee Class<\/p>\n<p>[sourcecode language=&#8221;csharp&#8221;]<br \/>\nusing\u00a0System;<br \/>\nusing\u00a0Common;<\/p>\n<p>namespace\u00a0DB<br \/>\n{<br \/>\npublic\u00a0class\u00a0Employee:IEmployee<br \/>\n{<br \/>\npublic\u00a0int\u00a0Id\u00a0{\u00a0get;\u00a0set;\u00a0}<\/p>\n<p>public\u00a0string\u00a0Name\u00a0{\u00a0get;\u00a0set;\u00a0}<\/p>\n<p>public\u00a0DateTime\u00a0BirthDate\u00a0{\u00a0get;\u00a0set;\u00a0}<br \/>\n}<br \/>\n}<br \/>\n[\/sourcecode]<\/p>\n<p>The Method under the Test<\/p>\n<p>[sourcecode language=&#8221;csharp&#8221;]<br \/>\nusing\u00a0System;<br \/>\nusing\u00a0Common;<br \/>\nusing\u00a0DB;<\/p>\n<p>namespace\u00a0TryMole<br \/>\n{<br \/>\npublic\u00a0class\u00a0MyClas<br \/>\n{<br \/>\npublic\u00a0IDataBase\u00a0DataBase\u00a0{\u00a0get;\u00a0set;\u00a0}<\/p>\n<p>public\u00a0void\u00a0SaveEmployee(IEmployee\u00a0e)<br \/>\n{<br \/>\nif\u00a0(e\u00a0==\u00a0null)<br \/>\nthrow\u00a0new\u00a0ArgumentNullException();<br \/>\nif\u00a0(e.Id\u00a0&lt;=\u00a00)<br \/>\nthrow\u00a0new\u00a0ArgumentException();<br \/>\nif\u00a0(e.Id\u00a0&gt;\u00a05000)<br \/>\nthrow\u00a0new\u00a0ArgumentException();<br \/>\nDataBase.Save(e);<br \/>\n}<br \/>\n}<br \/>\n}<br \/>\n[\/sourcecode]<\/p>\n<p>Test Method<\/p>\n<p>[sourcecode language=&#8221;csharp&#8221;]<br \/>\n[TestMethod()]<br \/>\npublic\u00a0void\u00a0SaveEmployeeTest()<br \/>\n{<br \/>\nMyClas\u00a0target\u00a0=\u00a0new\u00a0MyClas();\u00a0\/\/\u00a0TODO:\u00a0Initialize\u00a0to\u00a0an\u00a0appropriate\u00a0value<br \/>\nvar\u00a0database\u00a0=\u00a0new\u00a0SIDataBase();<br \/>\ndatabase.SaveIEmployee\u00a0=\u00a0(IEmployee\u00a0emp)\u00a0=&gt;\u00a0true;<br \/>\ntarget.DataBase\u00a0=\u00a0database;<br \/>\nIEmployee\u00a0e\u00a0=\u00a0new\u00a0Employee\u00a0{\u00a0Id\u00a0=\u00a05\u00a0};<br \/>\ntarget.SaveEmployee(e);<br \/>\n}<br \/>\n[\/sourcecode]<\/p>\n<p>I included also a project that isolate .NET Framework DateTime to return 1\/1\/2000 Y2K Bug<\/p>\n<p>To download the project and Y2K project click the following link<\/p>\n<p><a title=\"Download\" href=\"https:\/\/skydrive.live.com\/#!\/?cid=4bcaa16d27b46600&amp;sc=documents&amp;uc=2&amp;id=4BCAA16D27B46600%211898\" target=\"_blank\">download<\/a><\/p>\n","protected":false},"excerpt":{"rendered":"<p>Moles is one of the Mocking framework for isolation dependencies &hellip;<\/p>\n<p class=\"read-more\"> <a class=\"ast-button\" href=\"https:\/\/mohamedradwan.com\/2011\/07\/21\/how-to-isolate-layers-and-other-library-using-moles-in-unit-testing\/\"> <span class=\"screen-reader-text\">How to isolate layers and other library using Moles in Unit Testing?<\/span> Read More<\/a><\/p>\n","protected":false},"author":2,"featured_media":7119,"comment_status":"open","ping_status":"open","sticky":false,"template":"","format":"standard","meta":{"site-sidebar-layout":"default","site-content-layout":"default","ast-global-header-display":"","ast-banner-title-visibility":"","ast-main-header-display":"","ast-hfb-above-header-display":"","ast-hfb-below-header-display":"","ast-hfb-mobile-header-display":"","site-post-title":"","ast-breadcrumbs-content":"","ast-featured-img":"","footer-sml-layout":"","theme-transparent-header-meta":"","adv-header-id-meta":"","stick-header-meta":"","header-above-stick-meta":"","header-main-stick-meta":"","header-below-stick-meta":"","footnotes":""},"categories":[16,47,48],"tags":[],"_links":{"self":[{"href":"https:\/\/mohamedradwan.com\/wp-json\/wp\/v2\/posts\/776"}],"collection":[{"href":"https:\/\/mohamedradwan.com\/wp-json\/wp\/v2\/posts"}],"about":[{"href":"https:\/\/mohamedradwan.com\/wp-json\/wp\/v2\/types\/post"}],"author":[{"embeddable":true,"href":"https:\/\/mohamedradwan.com\/wp-json\/wp\/v2\/users\/2"}],"replies":[{"embeddable":true,"href":"https:\/\/mohamedradwan.com\/wp-json\/wp\/v2\/comments?post=776"}],"version-history":[{"count":2,"href":"https:\/\/mohamedradwan.com\/wp-json\/wp\/v2\/posts\/776\/revisions"}],"predecessor-version":[{"id":7127,"href":"https:\/\/mohamedradwan.com\/wp-json\/wp\/v2\/posts\/776\/revisions\/7127"}],"wp:featuredmedia":[{"embeddable":true,"href":"https:\/\/mohamedradwan.com\/wp-json\/wp\/v2\/media\/7119"}],"wp:attachment":[{"href":"https:\/\/mohamedradwan.com\/wp-json\/wp\/v2\/media?parent=776"}],"wp:term":[{"taxonomy":"category","embeddable":true,"href":"https:\/\/mohamedradwan.com\/wp-json\/wp\/v2\/categories?post=776"},{"taxonomy":"post_tag","embeddable":true,"href":"https:\/\/mohamedradwan.com\/wp-json\/wp\/v2\/tags?post=776"}],"curies":[{"name":"wp","href":"https:\/\/api.w.org\/{rel}","templated":true}]}}