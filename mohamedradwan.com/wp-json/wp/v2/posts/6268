{"id":6268,"date":"2016-06-29T17:06:48","date_gmt":"2016-06-29T17:06:48","guid":{"rendered":"https:\/\/mohamedradwan.com\/?p=6268"},"modified":"2019-07-16T04:43:24","modified_gmt":"2019-07-16T04:43:24","slug":"how-to-configure-vm-policies-in-devtest-labs","status":"publish","type":"post","link":"https:\/\/mohamedradwan.com\/2016\/06\/29\/how-to-configure-vm-policies-in-devtest-labs\/","title":{"rendered":"How to configure VM policies in DevTest Labs"},"content":{"rendered":"<p><a href=\"#Intro\">Introduction<\/a><\/p>\n<p><a href=\"#Step 1\"><strong>\u00a01: Allowed VM sizes policy<\/strong><\/a><\/p>\n<p><a href=\"#Step 2\"><strong>\u00a02: Maximum VM\u2019s per user<\/strong><\/a><\/p>\n<p><a href=\"#Step 3\">\u00a0<strong>3: Total VM\u2019s allowed<\/strong><\/a><\/p>\n<p><strong><a href=\"#Step 4\">\u00a04: Auto Shutdown policy<\/a><\/strong><\/p>\n<p><a href=\"#Con\"><strong>Conclusion<\/strong><\/a><\/p>\n<hr \/>\n<h3 id=\"Intro\">Introduction<\/h3>\n<p>In one of my\u00a0previous posts <a href=\"https:\/\/mohamedradwan.com\/2016\/06\/29\/quick-overview-of-azure-devtest-labs\/\" target=\"_blank\" rel=\"noopener noreferrer\">Quick overview of Azure DevTest Labs<\/a> I&#8217;ve\u00a0explained what is <strong><a href=\"https:\/\/azure.microsoft.com\/en-us\/services\/devtest-lab\/\" target=\"_blank\" rel=\"noopener noreferrer\">Azure DevTest<\/a><\/strong> and main functionalities. In that post I&#8217;ve\u00a0also mentioned a little about <strong>VM policies<\/strong>. Developers can easily set lots of different for example the policy for number of <strong>Virtual Machines<\/strong> per each Lab user, which VM sizes are allowed for VM creation, policy for <a href=\"https:\/\/mohamedradwan.com\/2016\/06\/28\/microsoft-azure-scheduled-vm-shutdown-with-azure-automation\/\" target=\"_blank\" rel=\"noopener noreferrer\">Automate Shutdown of Virtual Machines<\/a> and so on. Each policy also has a possibility to configure the threshold for it and to set alerts. By configuring and setting policies you can minimize your cost and reduce the waste.<\/p>\n<h3 id=\"Step 1\">Step 1: Allowed VM sizes policy<\/h3>\n<p>You can find all <strong>VM policies<\/strong> by going to settings in your account. Cost of <strong>Virtual Machine<\/strong> running is also connected to its size and all information about pricing for different sizes are available on <strong>Microsoft Azure\u2019s Virtual Machines Pricing list<\/strong>, which is available on: <a href=\"https:\/\/azure.microsoft.com\/en-us\/pricing\/details\/virtual-machines\/#Windows\" target=\"_blank\" rel=\"noopener noreferrer\">https:\/\/azure.microsoft.com\/en-us\/pricing\/details\/virtual-machines\/#Windows<\/a>. Prices differ for Windows and <strong>Linux<\/strong> users; however, all information is accessible on upper link. Of course the bigger size of the <strong>Virtual Machine<\/strong> we choose, the higher will be the cost.<\/p>\n<p>1. Click on <strong>Settings<\/strong> button.<br \/>\n2. On the right side new column with all settings data will show up, from the list go to VM policies and click on policy <strong>Allowed VM sizes<\/strong>.<\/p>\n<p><a href=\"https:\/\/mohamedradwan.com\/2016\/06\/29\/how-to-configure-vm-policies-in-devtest-labs\/1-1-adding-vm-sizes-policy-in-devtest-labs\/\" rel=\"attachment wp-att-6269\"><img loading=\"lazy\" decoding=\"async\" class=\"alignnone wp-image-6269\" title=\"1-1 Adding VM sizes policy in DevTest Labs\" src=\"https:\/\/mohamedradwan.com\/wp-content\/uploads\/2016\/06\/1-1-Adding-VM-sizes-policy-in-DevTest-Labs.jpg\" alt=\"1-1 Adding VM sizes policy in DevTest Labs\" width=\"962\" height=\"516\" srcset=\"https:\/\/mohamedradwan.com\/wp-content\/uploads\/2016\/06\/1-1-Adding-VM-sizes-policy-in-DevTest-Labs.jpg 1009w, https:\/\/mohamedradwan.com\/wp-content\/uploads\/2016\/06\/1-1-Adding-VM-sizes-policy-in-DevTest-Labs-300x161.jpg 300w, https:\/\/mohamedradwan.com\/wp-content\/uploads\/2016\/06\/1-1-Adding-VM-sizes-policy-in-DevTest-Labs-768x412.jpg 768w\" sizes=\"(max-width: 962px) 100vw, 962px\" \/><\/a><\/p>\n<p>3. First click on <strong>Enable<\/strong> button, so that all options will be available for selection.<br \/>\n4. From the list of all <strong>VM sizes<\/strong>, choose only the ones that should be allowed to use. You can do that by clicking in the square on the left size of the <strong>Virtual Machine size name<\/strong>. When you will choose the sizes, the chosen ones will be colored in blue color.<br \/>\n5. Click on <strong>Save<\/strong> button to save selection.<br \/>\n6. You will\u00a0see that <strong>Policy<\/strong> has been saved.<\/p>\n<p><a href=\"https:\/\/mohamedradwan.com\/2016\/06\/29\/how-to-configure-vm-policies-in-devtest-labs\/1-2-allowed-vm-sizes-policy-in-devtest-labs\/\" rel=\"attachment wp-att-6270\"><img loading=\"lazy\" decoding=\"async\" class=\"alignnone wp-image-6270\" title=\"1-2 Allowed VM sizes policy in DevTest Labs\" src=\"https:\/\/mohamedradwan.com\/wp-content\/uploads\/2016\/06\/1-2-Allowed-VM-sizes-policy-in-DevTest-Labs.jpg\" alt=\"1-2 Allowed VM sizes policy in DevTest Labs\" width=\"763\" height=\"402\" srcset=\"https:\/\/mohamedradwan.com\/wp-content\/uploads\/2016\/06\/1-2-Allowed-VM-sizes-policy-in-DevTest-Labs.jpg 1014w, https:\/\/mohamedradwan.com\/wp-content\/uploads\/2016\/06\/1-2-Allowed-VM-sizes-policy-in-DevTest-Labs-300x158.jpg 300w, https:\/\/mohamedradwan.com\/wp-content\/uploads\/2016\/06\/1-2-Allowed-VM-sizes-policy-in-DevTest-Labs-768x404.jpg 768w\" sizes=\"(max-width: 763px) 100vw, 763px\" \/><\/a><\/p>\n<p>&nbsp;<\/p>\n<p class=\"blue\"><span class=\"ion-tip\">Tip<\/span> If you would like to learn more about different tools and ways for Team Foundation Server to Visual Studio Team Services migration, &#8211; have a look at the <a href=\"https:\/\/mohamedradwan.com\/2018\/03\/11\/published-a-quick-guide-about-real-stories-for-migrating-team-foundation-server-to-visual-studio-team-services\/\">quick guide about real stories for migrating Team Foundation Server to Visual Studio Team Services<\/a>. The guide describes some of the real migration scenarios and explains how to use different tools for several cases.<\/p>\n<p>&nbsp;<\/p>\n<h3 id=\"Step 2\">Step 2: Maximum VM\u2019s per user<\/h3>\n<p>The number of <strong>Virtual Machines<\/strong> that are linked to one user is directly connected to the cost of <strong>Virtual Machine<\/strong> in <strong>Microsoft Azure<\/strong>. In case that user tries to create a new <strong>VM<\/strong>, after the user limit has been reached, the error message will occur to the user, which will indicate that new VM cannot be created.<\/p>\n<p>1. Navigate back to <strong>VM<\/strong> <strong>policies tab<\/strong> and click on<strong> Maximum VMs per user policy<\/strong>.<br \/>\n2. Click on <strong>Enable<\/strong> button, so that the typing window will be available.<br \/>\n3. Type the <strong>number of VM\u2019s allowed per user<\/strong>.<br \/>\n4. Click on <strong>Save<\/strong> button.<br \/>\n5. You will\u00a0see that <strong>Policy<\/strong> has been saved.<\/p>\n<p><a href=\"https:\/\/mohamedradwan.com\/2016\/06\/29\/how-to-configure-vm-policies-in-devtest-labs\/2-maximum-vms-per-user-in-devtest-labs\/\" rel=\"attachment wp-att-6271\"><img loading=\"lazy\" decoding=\"async\" class=\"alignnone wp-image-6271\" title=\"2-Maximum VM\u2019s per user in DevTest Labs\" src=\"https:\/\/mohamedradwan.com\/wp-content\/uploads\/2016\/06\/2-Maximum-VM\u2019s-per-user-in-DevTest-Labs.jpg\" alt=\"2-Maximum VM\u2019s per user in DevTest Labs\" width=\"763\" height=\"411\" srcset=\"https:\/\/mohamedradwan.com\/wp-content\/uploads\/2016\/06\/2-Maximum-VM\u2019s-per-user-in-DevTest-Labs.jpg 1008w, https:\/\/mohamedradwan.com\/wp-content\/uploads\/2016\/06\/2-Maximum-VM\u2019s-per-user-in-DevTest-Labs-300x162.jpg 300w, https:\/\/mohamedradwan.com\/wp-content\/uploads\/2016\/06\/2-Maximum-VM\u2019s-per-user-in-DevTest-Labs-768x414.jpg 768w\" sizes=\"(max-width: 763px) 100vw, 763px\" \/><\/a><\/p>\n<p>&nbsp;<\/p>\n<p class=\"green\"><span class=\"ion-info\">More Info<\/span>The post <a href=\"https:\/\/mohamedradwan.com\/2018\/01\/16\/upgrade-to-tfs-2018-has-been-done-in-production\/\">Upgrade to TFS 2018 Has Been Done in Production<\/a> describes a full upgrade and migration from TFS2015 to TFS2018 and describes the improvements over the old TFS 2015.<\/p>\n<p>&nbsp;<\/p>\n<h3 id=\"Step 3\">Step 3: Total VM\u2019s allowed<\/h3>\n<p>The final cost also depends on the total <strong>Virtual Machines<\/strong> in your <strong>Lab<\/strong>. In order to control that cost, you can set the maximum number of <strong>Virtual Machines<\/strong> that are allowed to be used in your <strong>Lab<\/strong>.<\/p>\n<p>1. Navigate back to <strong>VM policies tab<\/strong> and click on <strong>Total VM\u2019s allowed<\/strong>.<br \/>\n2. Click on <strong>Enable button<\/strong>, so that the typing window will be available.<br \/>\n3. Type the <strong>number of VM\u2019s allowed in Lab<\/strong>.<br \/>\n4. Click on <strong>Save<\/strong> button.<br \/>\n5. You will\u00a0see that <strong>Policy<\/strong> has been saved.<\/p>\n<p><a href=\"https:\/\/mohamedradwan.com\/2016\/06\/29\/how-to-configure-vm-policies-in-devtest-labs\/3-total-vms-allowed-in-devtest-labs\/\" rel=\"attachment wp-att-6272\"><img loading=\"lazy\" decoding=\"async\" class=\"alignnone wp-image-6272\" title=\"3-Total VM\u2019s allowed in DevTest Labs\" src=\"https:\/\/mohamedradwan.com\/wp-content\/uploads\/2016\/06\/3-Total-VM\u2019s-allowed-in-DevTest-Labs.jpg\" alt=\"3-Total VM\u2019s allowed in DevTest Labs\" width=\"763\" height=\"405\" srcset=\"https:\/\/mohamedradwan.com\/wp-content\/uploads\/2016\/06\/3-Total-VM\u2019s-allowed-in-DevTest-Labs.jpg 1011w, https:\/\/mohamedradwan.com\/wp-content\/uploads\/2016\/06\/3-Total-VM\u2019s-allowed-in-DevTest-Labs-300x159.jpg 300w, https:\/\/mohamedradwan.com\/wp-content\/uploads\/2016\/06\/3-Total-VM\u2019s-allowed-in-DevTest-Labs-768x407.jpg 768w\" sizes=\"(max-width: 763px) 100vw, 763px\" \/><\/a><\/p>\n<h3 id=\"Step 4\">Step 4: Auto Shutdown policy<\/h3>\n<p>The final cost highly depends also on the working hours of all running <strong>Virtual Machines<\/strong>. This cost can be much lower with usage of <strong>Automate Shutdown<\/strong> for all <strong>Virtual Machines<\/strong>. This would mean that all <strong>Virtual Machines<\/strong> would be running only when this is really required. For example, if you don\u2019t use all <strong>Virtual Machines<\/strong> at night, you can stop them at that time. This policy will automatically apply <strong>Automate Shutdown<\/strong> for all <strong>Virtual Machines<\/strong>.<\/p>\n<p>1. Navigate back to <strong>VM policies tab<\/strong> and click on <strong>Auto shutdown<\/strong>.<br \/>\n2. Click on <strong>Enable<\/strong> button, so that the window with hours will be available.<br \/>\n3. Choose the <strong>time<\/strong> when the <strong>Virtual Machine<\/strong> should stop.<br \/>\n4. Click on <strong>Save<\/strong> button.<br \/>\n5. You will\u00a0see that <strong>Policy<\/strong> has been saved.<\/p>\n<p><a href=\"https:\/\/mohamedradwan.com\/2016\/06\/29\/how-to-configure-vm-policies-in-devtest-labs\/4-auto-shutdown-policy-in-devtest-labs\/\" rel=\"attachment wp-att-6273\"><img loading=\"lazy\" decoding=\"async\" class=\"alignnone wp-image-6273\" title=\"4-Auto Shutdown policy in DevTest Labs\" src=\"https:\/\/mohamedradwan.com\/wp-content\/uploads\/2016\/06\/4-Auto-Shutdown-policy-in-DevTest-Labs.jpg\" alt=\"4-Auto Shutdown policy in DevTest Labs\" width=\"763\" height=\"406\" srcset=\"https:\/\/mohamedradwan.com\/wp-content\/uploads\/2016\/06\/4-Auto-Shutdown-policy-in-DevTest-Labs.jpg 1011w, https:\/\/mohamedradwan.com\/wp-content\/uploads\/2016\/06\/4-Auto-Shutdown-policy-in-DevTest-Labs-300x160.jpg 300w, https:\/\/mohamedradwan.com\/wp-content\/uploads\/2016\/06\/4-Auto-Shutdown-policy-in-DevTest-Labs-768x409.jpg 768w\" sizes=\"(max-width: 763px) 100vw, 763px\" \/><\/a><\/p>\n<h3 id=\"Con\">Conclusion<\/h3>\n<p>By setting policies for your needs, you can highly reduce the cost of <strong>Virtual Machine<\/strong> running. In one of previous post <a href=\"https:\/\/mohamedradwan.com\/2016\/06\/28\/microsoft-azure-scheduled-vm-shutdown-with-azure-automation\/\" target=\"_blank\" rel=\"noopener noreferrer\">Microsoft Azure \u2013 Scheduled VM Shutdown with Azure Automation<\/a> it is\u00a0already described \u00a0how the usage of <strong>Virtual Machines<\/strong> with high configuration can be very expensive and how can you reduce the cost of <strong>Virtual Machines<\/strong> by reducing its working hours with <strong>Automated Shutdown<\/strong>. If you didn\u2019t already consider creating <strong>Automate Shutdown<\/strong> with <strong>Azure<\/strong>, you should definitely do that in <strong>DevTest Labs<\/strong>.<\/p>\n<p>&nbsp;<\/p>\n<p class=\"gray\"><span class=\"ion-video\">Video<\/span>You can see <strong><a href=\"https:\/\/www.youtube.com\/watch?v=drPJmvZZ0gs\">this video<\/a><\/strong>, if you would like to find more information about how to generate unit tests and calculate the code coverage on the local machine, and how to perform the same process with VSTS and the Build on the cloud. You will see how to add your existing projects to VSTS, how to use Console.Read() function to prevent your app from closing, how to add a new project and create a hand-coded unit test in that project, and finally, how to generate unit tests with IntelliTest, which scans the code and suggests you all the possible unit testing cases. You will see the comparison of the Code Coverage of the hand-coded test with the generated unit test, the latter providing 100% Code Coverage.<\/p>\n<p>&nbsp;<\/p>\n","protected":false},"excerpt":{"rendered":"<p>Introduction \u00a01: Allowed VM sizes policy \u00a02: Maximum VM\u2019s per &hellip;<\/p>\n<p class=\"read-more\"> <a class=\"ast-button\" href=\"https:\/\/mohamedradwan.com\/2016\/06\/29\/how-to-configure-vm-policies-in-devtest-labs\/\"> <span class=\"screen-reader-text\">How to configure VM policies in DevTest Labs<\/span> Read More<\/a><\/p>\n","protected":false},"author":1,"featured_media":0,"comment_status":"open","ping_status":"open","sticky":false,"template":"","format":"standard","meta":{"site-sidebar-layout":"default","site-content-layout":"default","ast-global-header-display":"","ast-banner-title-visibility":"","ast-main-header-display":"","ast-hfb-above-header-display":"","ast-hfb-below-header-display":"","ast-hfb-mobile-header-display":"","site-post-title":"","ast-breadcrumbs-content":"","ast-featured-img":"","footer-sml-layout":"","theme-transparent-header-meta":"","adv-header-id-meta":"","stick-header-meta":"","header-above-stick-meta":"","header-main-stick-meta":"","header-below-stick-meta":"","footnotes":""},"categories":[16,18,23],"tags":[99,902,205],"_links":{"self":[{"href":"https:\/\/mohamedradwan.com\/wp-json\/wp\/v2\/posts\/6268"}],"collection":[{"href":"https:\/\/mohamedradwan.com\/wp-json\/wp\/v2\/posts"}],"about":[{"href":"https:\/\/mohamedradwan.com\/wp-json\/wp\/v2\/types\/post"}],"author":[{"embeddable":true,"href":"https:\/\/mohamedradwan.com\/wp-json\/wp\/v2\/users\/1"}],"replies":[{"embeddable":true,"href":"https:\/\/mohamedradwan.com\/wp-json\/wp\/v2\/comments?post=6268"}],"version-history":[{"count":4,"href":"https:\/\/mohamedradwan.com\/wp-json\/wp\/v2\/posts\/6268\/revisions"}],"predecessor-version":[{"id":9531,"href":"https:\/\/mohamedradwan.com\/wp-json\/wp\/v2\/posts\/6268\/revisions\/9531"}],"wp:attachment":[{"href":"https:\/\/mohamedradwan.com\/wp-json\/wp\/v2\/media?parent=6268"}],"wp:term":[{"taxonomy":"category","embeddable":true,"href":"https:\/\/mohamedradwan.com\/wp-json\/wp\/v2\/categories?post=6268"},{"taxonomy":"post_tag","embeddable":true,"href":"https:\/\/mohamedradwan.com\/wp-json\/wp\/v2\/tags?post=6268"}],"curies":[{"name":"wp","href":"https:\/\/api.w.org\/{rel}","templated":true}]}}