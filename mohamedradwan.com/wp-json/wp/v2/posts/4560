{"id":4560,"date":"2014-06-22T21:38:46","date_gmt":"2014-06-22T21:38:46","guid":{"rendered":"https:\/\/mohamedradwan.com\/?p=4560"},"modified":"2016-05-24T05:37:45","modified_gmt":"2016-05-24T05:37:45","slug":"how-to-call-a-batch-file-from-tfs2013-build","status":"publish","type":"post","link":"https:\/\/mohamedradwan.com\/2014\/06\/22\/how-to-call-a-batch-file-from-tfs2013-build\/","title":{"rendered":"How to Call a batch file from TFS2013 Build?"},"content":{"rendered":"<p>I run into\u00a0a situation which\u00a0needed to\u00a0run a batch file from <a title=\"Team Foundation Build Overview\" href=\"http:\/\/msdn.microsoft.com\/en-us\/library\/ms181710(v=vs.90).aspx\" target=\"_blank\">TFS Build<\/a>, this\u00a0batch file downloads some files from a file server and I just needed to copy that files later during the same build process to another machine.<\/p>\n<p>I will simulate that by creating\u00a0a batch file that create a file and copy the created file to another machine.<\/p>\n<p>Here is the batch file that create a new text file.<br \/>\n<a href=\"https:\/\/mohamedradwan.com\/2014\/06\/22\/how-to-call-a-batch-file-from-tfs2013-build\/6-22-2014-10-19-33-pm\/#main\" rel=\"attachment wp-att-4562\"><img loading=\"lazy\" decoding=\"async\" class=\"alignnone size-full wp-image-4562\" src=\"https:\/\/mohamedradwan.com\/wp-content\/uploads\/2014\/06\/6-22-2014-10-19-33-pm.jpg\" alt=\"6-22-2014 10-19-33 PM\" width=\"621\" height=\"349\" srcset=\"https:\/\/mohamedradwan.com\/wp-content\/uploads\/2014\/06\/6-22-2014-10-19-33-pm.jpg 621w, https:\/\/mohamedradwan.com\/wp-content\/uploads\/2014\/06\/6-22-2014-10-19-33-pm-300x169.jpg 300w\" sizes=\"(max-width: 621px) 100vw, 621px\" \/><br \/>\n<\/a>If I just double click on that file, it will create \u00a0a new file called NewFile.txt.<br \/>\n<a href=\"https:\/\/mohamedradwan.com\/2014\/06\/22\/how-to-call-a-batch-file-from-tfs2013-build\/6-18-2014-11-22-07-am\/#main\" rel=\"attachment wp-att-4566\"><img loading=\"lazy\" decoding=\"async\" class=\"alignnone size-large wp-image-4566\" src=\"https:\/\/mohamedradwan.com\/wp-content\/uploads\/2014\/06\/6-18-2014-11-22-07-am.jpg?w=660\" alt=\"6-18-2014 11-22-07 AM\" width=\"660\" height=\"198\" srcset=\"https:\/\/mohamedradwan.com\/wp-content\/uploads\/2014\/06\/6-18-2014-11-22-07-am.jpg 845w, https:\/\/mohamedradwan.com\/wp-content\/uploads\/2014\/06\/6-18-2014-11-22-07-am-300x90.jpg 300w, https:\/\/mohamedradwan.com\/wp-content\/uploads\/2014\/06\/6-18-2014-11-22-07-am-768x231.jpg 768w\" sizes=\"(max-width: 660px) 100vw, 660px\" \/><\/a><\/p>\n<ol>\n<li>Open any <strong>Build Process Template<\/strong> and delete all its activities.<\/li>\n<li>Add <strong>Sequence<\/strong> Activity with name: <strong>Overall Build Process<\/strong>.<\/li>\n<li>Drag and drop <a title=\"Get a reference to the IBuildDetail object (GetBuildDetail activity)\" href=\"http:\/\/msdn.microsoft.com\/en-us\/library\/gg265783.aspx#Activity_GetBuildDetail\" target=\"_blank\"><strong>GetBuildDetail<\/strong> <\/a>Activity inside the <strong>Sequence<\/strong> Activity.<\/li>\n<li>Drag and drop <strong>AgentScope<\/strong> Activity with name: <strong>Run on Agent<\/strong>.<\/li>\n<li>Drag and drop <strong>GetBuildDirectory<\/strong> Activity inside <strong>AgentScope<\/strong> Activity.<\/li>\n<li>Drag and drop <strong>InvokeProcess<\/strong> Activity with name: <strong>Call a batch file<\/strong>.<\/li>\n<li>Declare variable of type\u00a0<a title=\"IBuildDetail Interface\" href=\"http:\/\/msdn.microsoft.com\/en-us\/library\/microsoft.teamfoundation.build.client.ibuilddetail.aspx\" target=\"_blank\"><strong>IBuildDetail<\/strong>\u00a0<\/a>with name: <strong>MyBuildDetail,<\/strong>and assign the return value from <strong><a title=\"Get a reference to the IBuildDetail object (GetBuildDetail activity)\" href=\"http:\/\/msdn.microsoft.com\/en-us\/library\/gg265783.aspx#Activity_GetBuildDetail\" target=\"_blank\">GetBuildDetail<\/a>\u00a0<\/strong>to it.<\/li>\n<li>Declare variable of type<strong> String<\/strong> with name: <strong>MyBuildDirectory,<\/strong>and assign the return value from <strong>GetBuildDirectory\u00a0<\/strong>to it. <a title=\" JUNE 22, 2014 BY MOHAMED RADWAN (MVP) How to Copy Build output to a Lab Environment Machine for TFS2013\" href=\"https:\/\/mohamedradwan.com\/2014\/06\/22\/how-to-copy-build-output-to-a-lab-environment-machine-for-tfs2013\/\" target=\"_blank\">More information on how to assign a value to variable from the return execution of\u00a0activity<\/a><\/li>\n<\/ol>\n<p><a href=\"https:\/\/mohamedradwan.com\/2014\/06\/22\/how-to-call-a-batch-file-from-tfs2013-build\/6-18-2014-10-33-40-am\/#main\" rel=\"attachment wp-att-4563\"><img loading=\"lazy\" decoding=\"async\" class=\"alignnone size-large wp-image-4563\" src=\"https:\/\/mohamedradwan.com\/wp-content\/uploads\/2014\/06\/6-18-2014-10-33-40-am.jpg?w=660\" alt=\"6-18-2014 10-33-40 AM\" width=\"660\" height=\"426\" srcset=\"https:\/\/mohamedradwan.com\/wp-content\/uploads\/2014\/06\/6-18-2014-10-33-40-am.jpg 986w, https:\/\/mohamedradwan.com\/wp-content\/uploads\/2014\/06\/6-18-2014-10-33-40-am-300x194.jpg 300w, https:\/\/mohamedradwan.com\/wp-content\/uploads\/2014\/06\/6-18-2014-10-33-40-am-768x496.jpg 768w\" sizes=\"(max-width: 660px) 100vw, 660px\" \/><br \/>\n<\/a><\/p>\n<p>We need to\u00a0include\u00a0the folder that contains the script or the batch file in the Source Settings of our\u00a0<strong>Build Definition;\u00a0<\/strong>so the build server copy it in the working directory of the build.<\/p>\n<p>But first, let&#8217;s remember what is the working directory of the build, it&#8217;s a\u00a0folder like a temp folder the build process uses to get the last change set so it could build it, we configure that from <strong>TFS Administration Console<\/strong>\u00a0for the agent.<br \/>\n<a href=\"https:\/\/mohamedradwan.com\/2014\/06\/22\/how-to-call-a-batch-file-from-tfs2013-build\/6-18-2014-11-16-11-am\/#main\" rel=\"attachment wp-att-4567\"><img loading=\"lazy\" decoding=\"async\" class=\"alignnone size-large wp-image-4567\" src=\"https:\/\/mohamedradwan.com\/wp-content\/uploads\/2014\/06\/6-18-2014-11-16-11-am.jpg?w=660\" alt=\"6-18-2014 11-16-11 AM\" width=\"660\" height=\"406\" srcset=\"https:\/\/mohamedradwan.com\/wp-content\/uploads\/2014\/06\/6-18-2014-11-16-11-am.jpg 1046w, https:\/\/mohamedradwan.com\/wp-content\/uploads\/2014\/06\/6-18-2014-11-16-11-am-300x185.jpg 300w, https:\/\/mohamedradwan.com\/wp-content\/uploads\/2014\/06\/6-18-2014-11-16-11-am-768x474.jpg 768w, https:\/\/mohamedradwan.com\/wp-content\/uploads\/2014\/06\/6-18-2014-11-16-11-am-1024x631.jpg 1024w\" sizes=\"(max-width: 660px) 100vw, 660px\" \/><br \/>\n<\/a>So we will need to include\u00a0the folder that contains the script or the batch file in the Source Settings of our <strong>Build Definition<\/strong>.<br \/>\n<a href=\"https:\/\/mohamedradwan.com\/2014\/06\/22\/how-to-call-a-batch-file-from-tfs2013-build\/6-18-2014-11-13-02-am\/#main\" rel=\"attachment wp-att-4568\"><img loading=\"lazy\" decoding=\"async\" class=\"alignnone size-large wp-image-4568\" src=\"https:\/\/mohamedradwan.com\/wp-content\/uploads\/2014\/06\/6-18-2014-11-13-02-am.jpg?w=660\" alt=\"6-18-2014 11-13-02 AM\" width=\"660\" height=\"417\" srcset=\"https:\/\/mohamedradwan.com\/wp-content\/uploads\/2014\/06\/6-18-2014-11-13-02-am.jpg 910w, https:\/\/mohamedradwan.com\/wp-content\/uploads\/2014\/06\/6-18-2014-11-13-02-am-300x190.jpg 300w, https:\/\/mohamedradwan.com\/wp-content\/uploads\/2014\/06\/6-18-2014-11-13-02-am-768x486.jpg 768w\" sizes=\"(max-width: 660px) 100vw, 660px\" \/><\/a><\/p>\n<p>So now if we run this build, we will find that it gets the last change set including the script.<br \/>\n<a href=\"https:\/\/mohamedradwan.com\/2014\/06\/22\/how-to-call-a-batch-file-from-tfs2013-build\/6-18-2014-11-17-43-am\/#main\" rel=\"attachment wp-att-4569\"><img loading=\"lazy\" decoding=\"async\" class=\"alignnone size-large wp-image-4569\" src=\"https:\/\/mohamedradwan.com\/wp-content\/uploads\/2014\/06\/6-18-2014-11-17-43-am.jpg?w=660\" alt=\"6-18-2014 11-17-43 AM\" width=\"660\" height=\"177\" srcset=\"https:\/\/mohamedradwan.com\/wp-content\/uploads\/2014\/06\/6-18-2014-11-17-43-am.jpg 853w, https:\/\/mohamedradwan.com\/wp-content\/uploads\/2014\/06\/6-18-2014-11-17-43-am-300x81.jpg 300w, https:\/\/mohamedradwan.com\/wp-content\/uploads\/2014\/06\/6-18-2014-11-17-43-am-768x207.jpg 768w\" sizes=\"(max-width: 660px) 100vw, 660px\" \/><\/a><\/p>\n<p>So now I can give the\u00a0<strong>InvokeProcess<\/strong>\u00a0Activity the path on the working directory as the following.<br \/>\n<a href=\"https:\/\/mohamedradwan.com\/2014\/06\/22\/how-to-call-a-batch-file-from-tfs2013-build\/6-18-2014-11-02-17-am\/#main\" rel=\"attachment wp-att-4570\"><img loading=\"lazy\" decoding=\"async\" class=\"alignnone size-large wp-image-4570\" src=\"https:\/\/mohamedradwan.com\/wp-content\/uploads\/2014\/06\/6-18-2014-11-02-17-am.jpg?w=660\" alt=\"6-18-2014 11-02-17 AM\" width=\"660\" height=\"320\" srcset=\"https:\/\/mohamedradwan.com\/wp-content\/uploads\/2014\/06\/6-18-2014-11-02-17-am.jpg 816w, https:\/\/mohamedradwan.com\/wp-content\/uploads\/2014\/06\/6-18-2014-11-02-17-am-300x146.jpg 300w, https:\/\/mohamedradwan.com\/wp-content\/uploads\/2014\/06\/6-18-2014-11-02-17-am-768x373.jpg 768w\" sizes=\"(max-width: 660px) 100vw, 660px\" \/><br \/>\n<\/a><\/p>\n<p>Remember if I run the build, the file will not be created in related path, but it will be in <strong>System 32<\/strong> folder<br \/>\n<a href=\"https:\/\/mohamedradwan.com\/2014\/06\/22\/how-to-call-a-batch-file-from-tfs2013-build\/6-18-2014-11-21-38-am\/#main\" rel=\"attachment wp-att-4571\"><img loading=\"lazy\" decoding=\"async\" class=\"alignnone size-large wp-image-4571\" src=\"https:\/\/mohamedradwan.com\/wp-content\/uploads\/2014\/06\/6-18-2014-11-21-38-am.jpg?w=660\" alt=\"6-18-2014 11-21-38 AM\" width=\"660\" height=\"297\" srcset=\"https:\/\/mohamedradwan.com\/wp-content\/uploads\/2014\/06\/6-18-2014-11-21-38-am.jpg 813w, https:\/\/mohamedradwan.com\/wp-content\/uploads\/2014\/06\/6-18-2014-11-21-38-am-300x135.jpg 300w, https:\/\/mohamedradwan.com\/wp-content\/uploads\/2014\/06\/6-18-2014-11-21-38-am-768x347.jpg 768w\" sizes=\"(max-width: 660px) 100vw, 660px\" \/><\/a><\/p>\n<p>Then I will need to copy that file to the needed machine, see the following post for typical\u00a0steps.<\/p>\n<p><a title=\"How to Copy Build output to a Lab Environment Machine for TFS2013\" href=\"https:\/\/mohamedradwan.com\/2014\/06\/22\/how-to-copy-build-output-to-a-lab-environment-machine-for-tfs2013\/\" target=\"_blank\">How to Copy Build output to a Lab Environment Machine for TFS2013<\/a><\/p>\n","protected":false},"excerpt":{"rendered":"<p>I run into\u00a0a situation which\u00a0needed to\u00a0run a batch file from &hellip;<\/p>\n<p class=\"read-more\"> <a class=\"ast-button\" href=\"https:\/\/mohamedradwan.com\/2014\/06\/22\/how-to-call-a-batch-file-from-tfs2013-build\/\"> <span class=\"screen-reader-text\">How to Call a batch file from TFS2013 Build?<\/span> Read More<\/a><\/p>\n","protected":false},"author":1,"featured_media":0,"comment_status":"open","ping_status":"open","sticky":false,"template":"","format":"standard","meta":{"site-sidebar-layout":"default","site-content-layout":"default","ast-global-header-display":"","ast-banner-title-visibility":"","ast-main-header-display":"","ast-hfb-above-header-display":"","ast-hfb-below-header-display":"","ast-hfb-mobile-header-display":"","site-post-title":"","ast-breadcrumbs-content":"","ast-featured-img":"","footer-sml-layout":"","theme-transparent-header-meta":"","adv-header-id-meta":"","stick-header-meta":"","header-above-stick-meta":"","header-main-stick-meta":"","header-below-stick-meta":"","footnotes":""},"categories":[17,28,43],"tags":[],"_links":{"self":[{"href":"https:\/\/mohamedradwan.com\/wp-json\/wp\/v2\/posts\/4560"}],"collection":[{"href":"https:\/\/mohamedradwan.com\/wp-json\/wp\/v2\/posts"}],"about":[{"href":"https:\/\/mohamedradwan.com\/wp-json\/wp\/v2\/types\/post"}],"author":[{"embeddable":true,"href":"https:\/\/mohamedradwan.com\/wp-json\/wp\/v2\/users\/1"}],"replies":[{"embeddable":true,"href":"https:\/\/mohamedradwan.com\/wp-json\/wp\/v2\/comments?post=4560"}],"version-history":[{"count":2,"href":"https:\/\/mohamedradwan.com\/wp-json\/wp\/v2\/posts\/4560\/revisions"}],"predecessor-version":[{"id":5985,"href":"https:\/\/mohamedradwan.com\/wp-json\/wp\/v2\/posts\/4560\/revisions\/5985"}],"wp:attachment":[{"href":"https:\/\/mohamedradwan.com\/wp-json\/wp\/v2\/media?parent=4560"}],"wp:term":[{"taxonomy":"category","embeddable":true,"href":"https:\/\/mohamedradwan.com\/wp-json\/wp\/v2\/categories?post=4560"},{"taxonomy":"post_tag","embeddable":true,"href":"https:\/\/mohamedradwan.com\/wp-json\/wp\/v2\/tags?post=4560"}],"curies":[{"name":"wp","href":"https:\/\/api.w.org\/{rel}","templated":true}]}}