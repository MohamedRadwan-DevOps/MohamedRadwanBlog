{"id":8678,"date":"2019-01-17T04:41:44","date_gmt":"2019-01-17T04:41:44","guid":{"rendered":"https:\/\/mohamedradwan.com\/?p=8678"},"modified":"2019-07-08T06:20:30","modified_gmt":"2019-07-08T06:20:30","slug":"powershell-tips","status":"publish","type":"post","link":"https:\/\/mohamedradwan.com\/2019\/01\/17\/powershell-tips\/","title":{"rendered":"PowerShell Tips"},"content":{"rendered":"<p>In this post, I will just list some of the commands I used them during some of my work, many of them are very easy but the idea is to list them so I can remember what I have used \ud83d\ude42<\/p>\n<p><strong>Prompt for input\u00a0<\/strong><\/p>\n<pre class=\"lang:default decode:true\">$x= Read-Host -Prompt 'Please enter the value'\r\n\r\n<\/pre>\n<p>&nbsp;<\/p>\n<p>&nbsp;<\/p>\n<p class=\"blue\"><span class=\"ion-tip\">Tip<\/span> If you would like to learn more about how to work with SSRS PowerShell so we can remap SSRS or SQL Sever Reporting Server Database to an existing DB, we will see also how to restore SSRS encryption key &#8211; have a look at this post- have a look at the <a href=\" https:\/\/mohamedradwan.com\/2018\/04\/23\/working-with-ssrs-sql-server-reporting-server-powershell\/\"><strong>this post<\/strong><\/a><\/p>\n<p>&nbsp;<\/p>\n<h2><strong>Send argument and use it with Invoke-Command<\/strong><\/h2>\n<p>The argument sent at the end of the script block as an array, so if I want to access it within the script block, I just use it as $ args[0], or $args[1], etc.<\/p>\n<pre class=\"lang:default decode:true\">Invoke-Command -ComputerName \"MyRemotePC\" -Credential $cred -ScriptBlock {\r\n\r\n$args[0]\r\n$args[1]\r\n$args[2]\r\n\r\n} -ArgumentList $variable1,$variable2,$variable3\r\n\r\n<\/pre>\n<p>&nbsp;<\/p>\n<p>&nbsp;<\/p>\n<p class=\"green\"><span class=\"ion-info\">More Info<\/span>If you would like to know more about Azure deployments, have a look at the post <a href=\"https:\/\/mohamedradwan.com\/2018\/02\/12\/how-to-deploy-to-azure-using-team-services-release-management\/\">How to deploy to Azure using Team Services Release Management<\/a>. The post describes how Azure deployments are made easy by using Visual Studio Team Services (VSTS) Release Management. You will see a step-by-step tutorial on how to configure and deploy to Azure in Release Management, and, moreover, how to configure an end-to-end pipeline for deploying applications on Azure.<\/p>\n<p>&nbsp;<\/p>\n<p><strong>Execution Policy\u00a0<\/strong><\/p>\n<p><a href=\"https:\/\/docs.microsoft.com\/en-us\/powershell\/module\/microsoft.powershell.security\/set-executionpolicy?view=powershell-6\" target=\"_blank\" rel=\"noopener noreferrer\">https:\/\/docs.microsoft.com\/en-us\/powershell\/module\/microsoft.powershell.security\/set-executionpolicy?view=powershell-6<\/a><\/p>\n<p>The Default Execution Policy is set to restricted, we can see it by typing:<\/p>\n<pre class=\"lang:default decode:true\">Get-ExecutionPolicy<\/pre>\n<p>We can change it and type the following to make it go to unrestricted mode:<\/p>\n<pre class=\"lang:default decode:true\">Set-ExecutionPolicy unrestricted<\/pre>\n<p><strong><br \/>\nImport Module to use its command in the current session<\/strong><\/p>\n<pre class=\"lang:default decode:true\">Import-Module Module Name\r\n\r\nExamples:\r\n---------\r\nImport-Module WebAdministration\r\nImport-Module AzureRM\r\n\r\n<\/pre>\n<p>AzureRM Modules has sub Modules like:<\/p>\n<ul>\n<li>AzureRM.Profile<\/li>\n<li>Azure.Storage<\/li>\n<li>AzureRM.Automation<\/li>\n<li>AzureRM.Backup<\/li>\n<li>AzureRM.Billing<\/li>\n<li>AzureRM.ContainerRegistry<\/li>\n<li>AzureRM.DevTestLabs<\/li>\n<li>AzureRM.KeyVault<\/li>\n<li>And many others.<\/li>\n<\/ul>\n<p><strong>Get what are the current Modules loaded in the\u00a0current session<\/strong><\/p>\n<pre class=\"lang:default decode:true\">Get-Module<\/pre>\n<figure id=\"attachment_8995\" aria-describedby=\"caption-attachment-8995\" style=\"width: 844px\" class=\"wp-caption alignnone\"><a href=\"https:\/\/mohamedradwan.com\/2019\/01\/17\/powershell-tips\/get-module-powershell\/\" rel=\"attachment wp-att-8995\"><img loading=\"lazy\" decoding=\"async\" class=\"size-full wp-image-8995\" src=\"https:\/\/mohamedradwan.com\/wp-content\/uploads\/2019\/01\/Get-Module-PowerShell.png\" alt=\"Get-Module PowerShell\" width=\"844\" height=\"151\" srcset=\"https:\/\/mohamedradwan.com\/wp-content\/uploads\/2019\/01\/Get-Module-PowerShell.png 844w, https:\/\/mohamedradwan.com\/wp-content\/uploads\/2019\/01\/Get-Module-PowerShell-300x54.png 300w, https:\/\/mohamedradwan.com\/wp-content\/uploads\/2019\/01\/Get-Module-PowerShell-768x137.png 768w\" sizes=\"(max-width: 844px) 100vw, 844px\" \/><\/a><figcaption id=\"caption-attachment-8995\" class=\"wp-caption-text\">Get-Module PowerShell<\/figcaption><\/figure>\n<p>&nbsp;<\/p>\n<p><strong>Get-Command to list all the command inside\u00a0a\u00a0loaded Module<\/strong><\/p>\n<pre class=\"lang:default decode:true\">Get-Command -Module Module Name\r\n\r\nExamples:\r\n---------\r\nGet-Command -Module AzureRM.Profile\r\n\r\n<\/pre>\n<figure id=\"attachment_8996\" aria-describedby=\"caption-attachment-8996\" style=\"width: 734px\" class=\"wp-caption alignnone\"><a href=\"https:\/\/mohamedradwan.com\/2019\/01\/17\/powershell-tips\/get-command-module-azure\/\" rel=\"attachment wp-att-8996\"><img loading=\"lazy\" decoding=\"async\" class=\"size-full wp-image-8996\" src=\"https:\/\/mohamedradwan.com\/wp-content\/uploads\/2019\/01\/Get-command-Module-Azure.png\" alt=\"Get-command -Module Module Name\" width=\"734\" height=\"224\" srcset=\"https:\/\/mohamedradwan.com\/wp-content\/uploads\/2019\/01\/Get-command-Module-Azure.png 734w, https:\/\/mohamedradwan.com\/wp-content\/uploads\/2019\/01\/Get-command-Module-Azure-300x92.png 300w\" sizes=\"(max-width: 734px) 100vw, 734px\" \/><\/a><figcaption id=\"caption-attachment-8996\" class=\"wp-caption-text\">Get-command -Module\u00a0Module Name<\/figcaption><\/figure>\n<p><strong>Get-help to get help about desired command<\/strong><\/p>\n<pre class=\"lang:default decode:true\">Get-help Add-AzureRMAccount<\/pre>\n<div class=\"mceTemp\"><\/div>\n<figure id=\"attachment_8997\" aria-describedby=\"caption-attachment-8997\" style=\"width: 821px\" class=\"wp-caption alignnone\"><a href=\"https:\/\/mohamedradwan.com\/2019\/01\/17\/powershell-tips\/powershell-get-help-command\/\" rel=\"attachment wp-att-8997\"><img loading=\"lazy\" decoding=\"async\" class=\"size-full wp-image-8997\" src=\"https:\/\/mohamedradwan.com\/wp-content\/uploads\/2019\/01\/PowerShell-get-help-command.png\" alt=\"PowerShell get-help command\" width=\"821\" height=\"571\" srcset=\"https:\/\/mohamedradwan.com\/wp-content\/uploads\/2019\/01\/PowerShell-get-help-command.png 821w, https:\/\/mohamedradwan.com\/wp-content\/uploads\/2019\/01\/PowerShell-get-help-command-300x209.png 300w, https:\/\/mohamedradwan.com\/wp-content\/uploads\/2019\/01\/PowerShell-get-help-command-768x534.png 768w\" sizes=\"(max-width: 821px) 100vw, 821px\" \/><\/a><figcaption id=\"caption-attachment-8997\" class=\"wp-caption-text\">PowerShell get-help command<\/figcaption><\/figure>\n<p><strong>Get-help examples to get examples of desired command<\/strong><\/p>\n<pre class=\"lang:default decode:true\">Get-help Add-AzureRMAccount -examples<\/pre>\n<div class=\"mceTemp\"><\/div>\n<figure id=\"attachment_8998\" aria-describedby=\"caption-attachment-8998\" style=\"width: 763px\" class=\"wp-caption alignnone\"><a href=\"https:\/\/mohamedradwan.com\/2019\/01\/17\/powershell-tips\/powershell-get-help-examples\/\" rel=\"attachment wp-att-8998\"><img loading=\"lazy\" decoding=\"async\" class=\"size-full wp-image-8998\" src=\"https:\/\/mohamedradwan.com\/wp-content\/uploads\/2019\/01\/PowerShell-get-help-examples.png\" alt=\"PowerShell get help examples\" width=\"763\" height=\"259\" srcset=\"https:\/\/mohamedradwan.com\/wp-content\/uploads\/2019\/01\/PowerShell-get-help-examples.png 763w, https:\/\/mohamedradwan.com\/wp-content\/uploads\/2019\/01\/PowerShell-get-help-examples-300x102.png 300w\" sizes=\"(max-width: 763px) 100vw, 763px\" \/><\/a><figcaption id=\"caption-attachment-8998\" class=\"wp-caption-text\">PowerShell get help examples<\/figcaption><\/figure>\n<p><b>\u00a0<\/b><\/p>\n","protected":false},"excerpt":{"rendered":"<p>In this post, I will just list some of the &hellip;<\/p>\n<p class=\"read-more\"> <a class=\"ast-button\" href=\"https:\/\/mohamedradwan.com\/2019\/01\/17\/powershell-tips\/\"> <span class=\"screen-reader-text\">PowerShell Tips<\/span> Read More<\/a><\/p>\n","protected":false},"author":1,"featured_media":8849,"comment_status":"open","ping_status":"open","sticky":false,"template":"","format":"standard","meta":{"site-sidebar-layout":"default","site-content-layout":"default","ast-global-header-display":"","ast-banner-title-visibility":"","ast-main-header-display":"","ast-hfb-above-header-display":"","ast-hfb-below-header-display":"","ast-hfb-mobile-header-display":"","site-post-title":"","ast-breadcrumbs-content":"","ast-featured-img":"","footer-sml-layout":"","theme-transparent-header-meta":"","adv-header-id-meta":"","stick-header-meta":"","header-above-stick-meta":"","header-main-stick-meta":"","header-below-stick-meta":"","footnotes":""},"categories":[16,922],"tags":[444],"_links":{"self":[{"href":"https:\/\/mohamedradwan.com\/wp-json\/wp\/v2\/posts\/8678"}],"collection":[{"href":"https:\/\/mohamedradwan.com\/wp-json\/wp\/v2\/posts"}],"about":[{"href":"https:\/\/mohamedradwan.com\/wp-json\/wp\/v2\/types\/post"}],"author":[{"embeddable":true,"href":"https:\/\/mohamedradwan.com\/wp-json\/wp\/v2\/users\/1"}],"replies":[{"embeddable":true,"href":"https:\/\/mohamedradwan.com\/wp-json\/wp\/v2\/comments?post=8678"}],"version-history":[{"count":5,"href":"https:\/\/mohamedradwan.com\/wp-json\/wp\/v2\/posts\/8678\/revisions"}],"predecessor-version":[{"id":9411,"href":"https:\/\/mohamedradwan.com\/wp-json\/wp\/v2\/posts\/8678\/revisions\/9411"}],"wp:featuredmedia":[{"embeddable":true,"href":"https:\/\/mohamedradwan.com\/wp-json\/wp\/v2\/media\/8849"}],"wp:attachment":[{"href":"https:\/\/mohamedradwan.com\/wp-json\/wp\/v2\/media?parent=8678"}],"wp:term":[{"taxonomy":"category","embeddable":true,"href":"https:\/\/mohamedradwan.com\/wp-json\/wp\/v2\/categories?post=8678"},{"taxonomy":"post_tag","embeddable":true,"href":"https:\/\/mohamedradwan.com\/wp-json\/wp\/v2\/tags?post=8678"}],"curies":[{"name":"wp","href":"https:\/\/api.w.org\/{rel}","templated":true}]}}