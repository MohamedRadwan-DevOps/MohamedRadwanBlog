{"id":8440,"date":"2018-04-23T22:41:53","date_gmt":"2018-04-23T22:41:53","guid":{"rendered":"https:\/\/mohamedradwan.com\/?p=8440"},"modified":"2019-07-09T11:06:53","modified_gmt":"2019-07-09T11:06:53","slug":"working-with-ssrs-sql-server-reporting-server-powershell","status":"publish","type":"post","link":"https:\/\/mohamedradwan.com\/2018\/04\/23\/working-with-ssrs-sql-server-reporting-server-powershell\/","title":{"rendered":"Working with SSRS (SQL Server Reporting Server) PowerShell"},"content":{"rendered":"<p>&nbsp;<\/p>\n<p>In this post we will see how to work with SSRS PowerShell so we can remap SSRS or SQL Sever Reporting Server Database to an existing DB, we will see also how to restore SSRS encryption key<\/p>\n<p>&nbsp;<\/p>\n<p class=\"gray\"><span class=\"ion-video\">Video<\/span>You can see <strong><a href=\"https:\/\/www.youtube.com\/watch?v=_cdH1XiBNrA\">this video<\/a><\/strong>, if you would like to find more information about how to restore the old database to the new SQL server by running the command line and TFS Restore tool.<\/p>\n<p>&nbsp;<\/p>\n<p>First download the PowerShell SSRS Modules using NuGet for PowerShell (NuGet Provider), Run PowerShell as admin and type the following:<\/p>\n<pre class=\"lang:default decode:true\">Install-Module -Name ReportingServicesTools<\/pre>\n<p>Because I didn\u2019t have NuGet for PowerShell, I got the following message<\/p>\n<p>&nbsp;<\/p>\n<pre class=\"lang:default decode:true \">NuGet provider is required to continue\r\nPowerShellGet requires NuGet provider version '2.8.5.201' or newer to interact with NuGet-based repositories. The NuGet provider must be available in 'C:\\Program\r\nFiles\\PackageManagement\\ProviderAssemblies' or 'C:\\Users\\mradwan\\AppData\\Local\\PackageManagement\\ProviderAssemblies'. You can also install the NuGet provider by running\r\n'Install-PackageProvider -Name NuGet -MinimumVersion 2.8.5.201 -Force'. Do you want PowerShellGet to install and import the NuGet provider now?\r\n[Y] Yes [N] No [S] Suspend [?] Help (default is \"Y\"):<\/pre>\n<p>By agree, it will install both, NuGet and SSRS PowerShell Modules, to displayed all the commands in that module, type<\/p>\n<p>&nbsp;<\/p>\n<pre class=\"lang:default decode:true\">Get-Command -Module ReportingServicesTools<\/pre>\n<p>This will display all the command<\/p>\n<p><a href=\"https:\/\/mohamedradwan.com\/2018\/04\/23\/working-with-ssrs-sql-server-reporting-server-powershell\/module-reportingservicestools\/\" rel=\"attachment wp-att-8444\"><img loading=\"lazy\" decoding=\"async\" class=\"alignnone size-full wp-image-8444\" src=\"https:\/\/mohamedradwan.com\/wp-content\/uploads\/2018\/04\/Module-ReportingServicesTools.png\" alt=\"Module ReportingServicesTools\" width=\"721\" height=\"867\" srcset=\"https:\/\/mohamedradwan.com\/wp-content\/uploads\/2018\/04\/Module-ReportingServicesTools.png 721w, https:\/\/mohamedradwan.com\/wp-content\/uploads\/2018\/04\/Module-ReportingServicesTools-249x300.png 249w\" sizes=\"(max-width: 721px) 100vw, 721px\" \/><\/a><\/p>\n<p>To know how to use the needed command, type<\/p>\n<p>&nbsp;<\/p>\n<pre class=\"lang:default decode:true \">get-help set-rsdatabase<\/pre>\n<p>This will download the latest help and display the help, to see some examples in how to use that command, type<\/p>\n<p>&nbsp;<\/p>\n<pre class=\"lang:default decode:true\">get-help set-rsdatabase -examples<\/pre>\n<figure id=\"attachment_8445\" aria-describedby=\"caption-attachment-8445\" style=\"width: 760px\" class=\"wp-caption alignnone\"><a href=\"https:\/\/mohamedradwan.com\/2018\/04\/23\/working-with-ssrs-sql-server-reporting-server-powershell\/rsdatabase-examples\/\" rel=\"attachment wp-att-8445\"><img loading=\"lazy\" decoding=\"async\" class=\"size-large wp-image-8445\" src=\"https:\/\/mohamedradwan.com\/wp-content\/uploads\/2018\/04\/rsdatabase-examples-1024x244.png\" alt=\"rsdatabase -examples\" width=\"760\" height=\"181\" srcset=\"https:\/\/mohamedradwan.com\/wp-content\/uploads\/2018\/04\/rsdatabase-examples-1024x244.png 1024w, https:\/\/mohamedradwan.com\/wp-content\/uploads\/2018\/04\/rsdatabase-examples-300x71.png 300w, https:\/\/mohamedradwan.com\/wp-content\/uploads\/2018\/04\/rsdatabase-examples-768x183.png 768w, https:\/\/mohamedradwan.com\/wp-content\/uploads\/2018\/04\/rsdatabase-examples.png 1177w\" sizes=\"(max-width: 760px) 100vw, 760px\" \/><\/a><figcaption id=\"caption-attachment-8445\" class=\"wp-caption-text\">rsdatabase -examples<\/figcaption><\/figure>\n<p>Change the SSRS Database to map to the old DB, I used the new name of the machine<\/p>\n<p>&nbsp;<\/p>\n<pre class=\"lang:default decode:true\">Set-RsDatabase -DatabaseServerName MyServer_Name -Name MyReportServerDB_Name -IsExistingDatabase -DatabaseCredentialType ServiceAccount -Confirm:$false<\/pre>\n<p>Restore SSRS Encryption Key<\/p>\n<p>&nbsp;<\/p>\n<pre class=\"lang:default decode:true\">Restore-RSEncryptionKey -Password 'MyPassword' -KeyPath 'C:\\Partial Autoamtion\\CRMSRSReportKey.snk'<\/pre>\n<p>&nbsp;<\/p>\n<p class=\"blue\"><span class=\"ion-tip\">Tip<\/span> If you would like to learn more about different tools and ways for Team Foundation Server to Visual Studio Team Services migration, &#8211; have a look at the <a href=\"https:\/\/mohamedradwan.com\/2018\/03\/11\/published-a-quick-guide-about-real-stories-for-migrating-team-foundation-server-to-visual-studio-team-services\/\">quick guide about real stories for migrating Team Foundation Server to Visual Studio Team Services<\/a>. The guide describes some of the real migration scenarios and explains how to use different tools for several cases.<\/p>\n<p>&nbsp;<\/p>\n","protected":false},"excerpt":{"rendered":"<p>&nbsp; In this post we will see how to work &hellip;<\/p>\n<p class=\"read-more\"> <a class=\"ast-button\" href=\"https:\/\/mohamedradwan.com\/2018\/04\/23\/working-with-ssrs-sql-server-reporting-server-powershell\/\"> <span class=\"screen-reader-text\">Working with SSRS (SQL Server Reporting Server) PowerShell<\/span> Read More<\/a><\/p>\n","protected":false},"author":1,"featured_media":8465,"comment_status":"open","ping_status":"open","sticky":false,"template":"","format":"standard","meta":{"site-sidebar-layout":"default","site-content-layout":"default","ast-global-header-display":"","ast-banner-title-visibility":"","ast-main-header-display":"","ast-hfb-above-header-display":"","ast-hfb-below-header-display":"","ast-hfb-mobile-header-display":"","site-post-title":"","ast-breadcrumbs-content":"","ast-featured-img":"","footer-sml-layout":"","theme-transparent-header-meta":"","adv-header-id-meta":"","stick-header-meta":"","header-above-stick-meta":"","header-main-stick-meta":"","header-below-stick-meta":"","footnotes":""},"categories":[16,922],"tags":[924,444,923,927,925,926],"_links":{"self":[{"href":"https:\/\/mohamedradwan.com\/wp-json\/wp\/v2\/posts\/8440"}],"collection":[{"href":"https:\/\/mohamedradwan.com\/wp-json\/wp\/v2\/posts"}],"about":[{"href":"https:\/\/mohamedradwan.com\/wp-json\/wp\/v2\/types\/post"}],"author":[{"embeddable":true,"href":"https:\/\/mohamedradwan.com\/wp-json\/wp\/v2\/users\/1"}],"replies":[{"embeddable":true,"href":"https:\/\/mohamedradwan.com\/wp-json\/wp\/v2\/comments?post=8440"}],"version-history":[{"count":6,"href":"https:\/\/mohamedradwan.com\/wp-json\/wp\/v2\/posts\/8440\/revisions"}],"predecessor-version":[{"id":8992,"href":"https:\/\/mohamedradwan.com\/wp-json\/wp\/v2\/posts\/8440\/revisions\/8992"}],"wp:featuredmedia":[{"embeddable":true,"href":"https:\/\/mohamedradwan.com\/wp-json\/wp\/v2\/media\/8465"}],"wp:attachment":[{"href":"https:\/\/mohamedradwan.com\/wp-json\/wp\/v2\/media?parent=8440"}],"wp:term":[{"taxonomy":"category","embeddable":true,"href":"https:\/\/mohamedradwan.com\/wp-json\/wp\/v2\/categories?post=8440"},{"taxonomy":"post_tag","embeddable":true,"href":"https:\/\/mohamedradwan.com\/wp-json\/wp\/v2\/tags?post=8440"}],"curies":[{"name":"wp","href":"https:\/\/api.w.org\/{rel}","templated":true}]}}