{"id":616,"date":"2011-01-07T23:58:44","date_gmt":"2011-01-07T23:58:44","guid":{"rendered":"https:\/\/mohamedradwan.com\/?p=528"},"modified":"2017-08-30T07:28:38","modified_gmt":"2017-08-30T07:28:38","slug":"the-relational-algebra-of-ramez-elmasri-in-sql-using-mssql-2008","status":"publish","type":"post","link":"https:\/\/mohamedradwan.com\/2011\/01\/07\/the-relational-algebra-of-ramez-elmasri-in-sql-using-mssql-2008\/","title":{"rendered":"The Relational Algebra of Ramez Elmasri as MSSQL 2008 DB"},"content":{"rendered":"<hr \/>\n<p><span style=\"color: #0000ff;\">******Updated\u00a0August\u00a02012 *********<\/span><\/p>\n<p>I used this post as DB SQL Kata, it&#8217;s really perfect for this\u00a0purpose, just give it a try to finish all these queries\u00a0in <strong>5 minutes or less<\/strong> from time to time and you will see how this will help you:-) enjoy&#8230;..<\/p>\n<p><span style=\"color: #0000ff;\">*****End of Update******<\/span><\/p>\n<p>From long time ago and I want to create this post that cover <strong>Chapter 6,\u00a0 The Relational Algebra and Calculus by Ramez Elmasri and Shamkant B. Navathe of Fundamentals of Database Systems,<\/strong> I study this book in the Pre-Master and of curse it&#8217;s a great book, when I prepare for my exam I search for the Database as MDF file or MS SQL script file but I didn&#8217;t found it so I decide to post an article that has the database and answer all question of\u00a0 Chapter 6 using SQL statements<\/p>\n<p>So you can download the scripts that create the database and insert the exactly data exist in Chapter 6\u00a0 in the database, just click on the following link<\/p>\n<p><a href=\"https:\/\/mohamedradwan.com\/wp-content\/uploads\/2017\/08\/Elmasri.zip\"><img loading=\"lazy\" decoding=\"async\" class=\"alignnone size-full wp-image-7151\" src=\"https:\/\/mohamedradwan.com\/wp-content\/uploads\/2011\/01\/download.jpg\" alt=\"Download\" width=\"232\" height=\"188\" \/><\/a><\/p>\n<p>So let&#8217;s start by introduce the schema<\/p>\n<p><img loading=\"lazy\" decoding=\"async\" class=\"alignnone  wp-image-7165\" src=\"https:\/\/mohamedradwan.com\/wp-content\/uploads\/2011\/01\/Schema.png\" alt=\"Schema\" width=\"724\" height=\"570\" srcset=\"https:\/\/mohamedradwan.com\/wp-content\/uploads\/2011\/01\/Schema.png 810w, https:\/\/mohamedradwan.com\/wp-content\/uploads\/2011\/01\/Schema-300x236.png 300w, https:\/\/mohamedradwan.com\/wp-content\/uploads\/2011\/01\/Schema-768x605.png 768w\" sizes=\"(max-width: 724px) 100vw, 724px\" \/><\/p>\n<p>And now let&#8217;s see the tables with the data that will be used throughout the chapter<\/p>\n<p><img loading=\"lazy\" decoding=\"async\" class=\"alignnone  wp-image-7162\" src=\"https:\/\/mohamedradwan.com\/wp-content\/uploads\/2011\/01\/Employee.png\" alt=\"Employee\" width=\"718\" height=\"187\" srcset=\"https:\/\/mohamedradwan.com\/wp-content\/uploads\/2011\/01\/Employee.png 1010w, https:\/\/mohamedradwan.com\/wp-content\/uploads\/2011\/01\/Employee-300x78.png 300w, https:\/\/mohamedradwan.com\/wp-content\/uploads\/2011\/01\/Employee-768x200.png 768w\" sizes=\"(max-width: 718px) 100vw, 718px\" \/><\/p>\n<p><img loading=\"lazy\" decoding=\"async\" class=\"alignnone size-full wp-image-7160\" src=\"https:\/\/mohamedradwan.com\/wp-content\/uploads\/2011\/01\/Department.png\" alt=\"Department\" width=\"406\" height=\"159\" srcset=\"https:\/\/mohamedradwan.com\/wp-content\/uploads\/2011\/01\/Department.png 406w, https:\/\/mohamedradwan.com\/wp-content\/uploads\/2011\/01\/Department-300x117.png 300w\" sizes=\"(max-width: 406px) 100vw, 406px\" \/><\/p>\n<p><img loading=\"lazy\" decoding=\"async\" class=\"alignnone size-full wp-image-7161\" src=\"https:\/\/mohamedradwan.com\/wp-content\/uploads\/2011\/01\/Dept_Locations.png\" alt=\"Dept_Locations\" width=\"200\" height=\"226\" \/><\/p>\n<p><img loading=\"lazy\" decoding=\"async\" class=\"alignnone size-full wp-image-7167\" src=\"https:\/\/mohamedradwan.com\/wp-content\/uploads\/2011\/01\/Works_on.png\" alt=\"Works_on\" width=\"303\" height=\"443\" srcset=\"https:\/\/mohamedradwan.com\/wp-content\/uploads\/2011\/01\/Works_on.png 303w, https:\/\/mohamedradwan.com\/wp-content\/uploads\/2011\/01\/Works_on-205x300.png 205w\" sizes=\"(max-width: 303px) 100vw, 303px\" \/><\/p>\n<p><img loading=\"lazy\" decoding=\"async\" class=\"alignnone size-full wp-image-7163\" src=\"https:\/\/mohamedradwan.com\/wp-content\/uploads\/2011\/01\/Instructor.png\" alt=\"Instructor\" width=\"307\" height=\"191\" srcset=\"https:\/\/mohamedradwan.com\/wp-content\/uploads\/2011\/01\/Instructor.png 307w, https:\/\/mohamedradwan.com\/wp-content\/uploads\/2011\/01\/Instructor-300x187.png 300w\" sizes=\"(max-width: 307px) 100vw, 307px\" \/><\/p>\n<p><img loading=\"lazy\" decoding=\"async\" class=\"alignnone size-full wp-image-7166\" src=\"https:\/\/mohamedradwan.com\/wp-content\/uploads\/2011\/01\/Student.png\" alt=\"Student\" width=\"410\" height=\"259\" srcset=\"https:\/\/mohamedradwan.com\/wp-content\/uploads\/2011\/01\/Student.png 410w, https:\/\/mohamedradwan.com\/wp-content\/uploads\/2011\/01\/Student-300x190.png 300w\" sizes=\"(max-width: 410px) 100vw, 410px\" \/><\/p>\n<p>The used Keywords<\/p>\n<ul>\n<li>intersect<\/li>\n<li>union<\/li>\n<li>except<\/li>\n<li>in<\/li>\n<li>not in<\/li>\n<li>is null<\/li>\n<li>is not null<\/li>\n<\/ul>\n<p>Here is the code<\/p>\n<p>[sourcecode language=&#8221;sql&#8221;]<br \/>\nuse CompanyElmasri<br \/>\n&#8211;Select the EMPLOYEEs whose department # is 4<br \/>\nselect Employee.Fname, Department.Dname,Department.Dnumber from Employee<br \/>\njoin Department on Employee.Dno =Department.Dnumber where Department.Dnumber =4<br \/>\n&#8211;==========================================================================<\/p>\n<p>&#8211;Select the EMPLOYEEs whose salary &amp;gt; $30,000<br \/>\nselect Employee.Fname, Employee.Salary from Employee where Employee.Salary &amp;gt; 30000<\/p>\n<p>&#8211;==========================================================================<br \/>\n&#8211;Intersection<\/p>\n<p>select Students.Fname from Students intersect select Instructors.Fname from Instructors<\/p>\n<p>&#8212; intersection using join<\/p>\n<p>select Students.Fname from Students join Instructors on Students.InstructorId=Instructors.Id<\/p>\n<p>&#8211;==========================================================================<br \/>\n&#8211;Union<br \/>\nselect Students.Fname from Students union select Instructors.Fname from Instructors<\/p>\n<p>&#8211;==========================================================================<br \/>\n&#8211;diffrence student &#8211; instructors<\/p>\n<p>select Students.Fname from Students EXCEPT select Instructors.Fname from Instructors<\/p>\n<p>&#8211;diffrence instructors &#8211; student<\/p>\n<p>select Instructors.Fname from Instructors EXCEPT select Students.Fname from Students<\/p>\n<p>&#8211;==========================================================================<\/p>\n<p>&#8211;Give the SSNs of those managers have dependent(s).<br \/>\nselect Employee.Fname,Employee.Ssn from Employee where Employee.Ssn in(select distinct Dependent.Essn from Dependent)<\/p>\n<p>&#8211;==========================================================================<br \/>\n&#8211;Give the SSNs non-manager employees<\/p>\n<p>select Employee.Fname , Employee.Ssn from Employee where Employee.Ssn not in (select distinct Employee.Super_ssn from Employee where Employee.Super_ssn is not null)<\/p>\n<p>&#8211;==========================================================================<br \/>\n&#8211;Give the SSNs of employees who are both supervisors and supervisees<\/p>\n<p>select Employee.Fname,Employee.Ssn from Employee where Employee.Ssn in (select distinct Employee.Super_ssn from Employee) and Employee.Super_ssn is not null<br \/>\n&#8211;==========================================================================<br \/>\n&#8211;To find the dependents\u2019 names of all female employees<\/p>\n<p>select Employee.Fname, Dependent.Dependent_name from Dependent join Employee on Employee.Ssn=Dependent.Essn where Employee.Sex = &#8216;F&#8217;<\/p>\n<p>&#8211;==========================================================================<br \/>\n&#8211;List the names of those departments that have at least one female employee whose salary &amp;gt;= $25000.<br \/>\nselect distinct Department.Dname,Employee.Sex from Department join Employee on Employee.Dno=Department.Dnumber where Employee.Sex=&#8217;F&#8217; and Employee.Salary &amp;gt;= 25000<\/p>\n<p>&#8211;==========================================================================<br \/>\n&#8211;List the Names and SSNs of the managers of the above departments<\/p>\n<p>select Employee.Fname,Employee.Ssn, Department.Dname from Employee join Department on Employee.Dno=Department.Dnumber where Employee.Ssn in (select Employee.Super_ssn from Employee)<\/p>\n<p>&#8211;==========================================================================<br \/>\n&#8211;find the dependents\u2019 names of all female employees<br \/>\nselect Dependent.Dependent_name from Dependent join Employee on Dependent.Essn =Employee.Ssn where Employee.Sex=&#8217;F&#8217;<\/p>\n<p>&#8211;==========================================================================<br \/>\n&#8211;List names and SSNs of those EMPLOYEE who work on some project(s) located in Houston<br \/>\nselect distinct Employee.Fname, Project.Plocation from Employee\u00a0 join Works_On on Employee.Ssn=Works_On.Essn join Project on Works_On.Pno=Project.Pnumber where Project.Plocation=&#8217;Houston&#8217;<\/p>\n<p>&#8211;==========================================================================<\/p>\n<p>&#8211;List the names and birth dates of all female dependents born after 1980<br \/>\nselect Dependent.Dependent_name,Dependent.Bdate from Dependent where Dependent.Bdate &amp;gt;&#8217;1980&#8242;<\/p>\n<p>&#8211;==========================================================================<br \/>\n&#8211;List the names of all employees who earns salary &amp;gt; $10,000 but does not supervise anyone<\/p>\n<p>select Employee.Fname from Employee where Employee.Salary &amp;gt; 10000 and Employee.Ssn not in (select distinct Employee.Super_ssn from Employee where Employee.Super_ssn is not null)<\/p>\n<p>&#8211;==========================================================================<\/p>\n<p>&#8211;Finished<\/p>\n<p>[\/sourcecode]<\/p>\n","protected":false},"excerpt":{"rendered":"<p>******Updated\u00a0August\u00a02012 ********* I used this post as DB SQL Kata, &hellip;<\/p>\n<p class=\"read-more\"> <a class=\"ast-button\" href=\"https:\/\/mohamedradwan.com\/2011\/01\/07\/the-relational-algebra-of-ramez-elmasri-in-sql-using-mssql-2008\/\"> <span class=\"screen-reader-text\">The Relational Algebra of Ramez Elmasri as MSSQL 2008 DB<\/span> Read More<\/a><\/p>\n","protected":false},"author":2,"featured_media":7151,"comment_status":"open","ping_status":"open","sticky":false,"template":"","format":"standard","meta":{"site-sidebar-layout":"default","site-content-layout":"default","ast-global-header-display":"","ast-banner-title-visibility":"","ast-main-header-display":"","ast-hfb-above-header-display":"","ast-hfb-below-header-display":"","ast-hfb-mobile-header-display":"","site-post-title":"","ast-breadcrumbs-content":"","ast-featured-img":"","footer-sml-layout":"","theme-transparent-header-meta":"","adv-header-id-meta":"","stick-header-meta":"","header-above-stick-meta":"","header-main-stick-meta":"","header-below-stick-meta":"","footnotes":""},"categories":[16,27],"tags":[],"_links":{"self":[{"href":"https:\/\/mohamedradwan.com\/wp-json\/wp\/v2\/posts\/616"}],"collection":[{"href":"https:\/\/mohamedradwan.com\/wp-json\/wp\/v2\/posts"}],"about":[{"href":"https:\/\/mohamedradwan.com\/wp-json\/wp\/v2\/types\/post"}],"author":[{"embeddable":true,"href":"https:\/\/mohamedradwan.com\/wp-json\/wp\/v2\/users\/2"}],"replies":[{"embeddable":true,"href":"https:\/\/mohamedradwan.com\/wp-json\/wp\/v2\/comments?post=616"}],"version-history":[{"count":2,"href":"https:\/\/mohamedradwan.com\/wp-json\/wp\/v2\/posts\/616\/revisions"}],"predecessor-version":[{"id":7168,"href":"https:\/\/mohamedradwan.com\/wp-json\/wp\/v2\/posts\/616\/revisions\/7168"}],"wp:featuredmedia":[{"embeddable":true,"href":"https:\/\/mohamedradwan.com\/wp-json\/wp\/v2\/media\/7151"}],"wp:attachment":[{"href":"https:\/\/mohamedradwan.com\/wp-json\/wp\/v2\/media?parent=616"}],"wp:term":[{"taxonomy":"category","embeddable":true,"href":"https:\/\/mohamedradwan.com\/wp-json\/wp\/v2\/categories?post=616"},{"taxonomy":"post_tag","embeddable":true,"href":"https:\/\/mohamedradwan.com\/wp-json\/wp\/v2\/tags?post=616"}],"curies":[{"name":"wp","href":"https:\/\/api.w.org\/{rel}","templated":true}]}}