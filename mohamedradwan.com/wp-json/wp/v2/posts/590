{"id":590,"date":"2010-10-09T10:52:58","date_gmt":"2010-10-09T10:52:58","guid":{"rendered":"https:\/\/mohamedradwan.com\/?p=227"},"modified":"2017-08-30T16:34:16","modified_gmt":"2017-08-30T16:34:16","slug":"msbuildextensionpack-how-to","status":"publish","type":"post","link":"https:\/\/mohamedradwan.com\/2010\/10\/09\/msbuildextensionpack-how-to\/","title":{"rendered":"MSBuildExtensionPack how to?"},"content":{"rendered":"<hr \/>\n<p>I am now interested of streamline the building and the deployment of the application to the QA or the Production because this process take too much time which are repetitive tasks that we should automate, so with the TeamBuild 2010 this will be very productive direction.<\/p>\n<p>so I read about MSBuildExtensionPack which is open source project exists on the <a href=\"http:\/\/msbuildextensionpack.codeplex.com\/\">codeplex<\/a> it has many tasks that you can execute during or after your build this depend on the target element you define, some of it&#8217;s task for example:<\/p>\n<ul>\n<li>System Items: Active Directory, Certificates, COM+, Console, Date and Time, Drives, Environment Variables, Event Logs, Files and Folders, FTP, GAC, Network, Performance Counters, Registry, Services, Sound<\/li>\n<li>Code: Assemblies, CAB Files, Code Signing, DynamicExecute, File Detokenisation, GUID\u2019s, Mathematics, Strings, Threads, Xml, Zip Files<\/li>\n<li>Applications: BizTalk 2006 \/ 2009, Email, IIS6, IIS7, MSBuild, SourceSafe, SQL Server 2005, SQL Server 2008, StyleCop, Twitter, Team Foundation Server, Visual Basic 6, Windows Virtual PC, WMI<\/li>\n<\/ul>\n<p>It&#8217;s has over 355 MSBuild Tasks<\/p>\n<p>So let&#8217;s start making a sample application from the beginning to the end that run an SQL script and pop-up a window with message<br \/>\nFirst install the package, it prefers to use the default location or other wise you need to write the <em>(FQN) <\/em>fully qualified name\u00a0 to the library\u00a0 it in your project file<\/p>\n<p>Read the help and see the sample file in the installation folder you will find example of most tasks you need<br \/>\nCreate your project that you want to use, let&#8217;s say it&#8217;s console Application<\/p>\n<ul>\n<li>Right click on the project and choose unload project\n<p><figure id=\"attachment_7273\" aria-describedby=\"caption-attachment-7273\" style=\"width: 599px\" class=\"wp-caption alignnone\"><img loading=\"lazy\" decoding=\"async\" class=\"size-full wp-image-7273\" src=\"https:\/\/mohamedradwan.com\/wp-content\/uploads\/2010\/10\/UnloadProject.jpg\" alt=\"How to unload project\" width=\"599\" height=\"632\" srcset=\"https:\/\/mohamedradwan.com\/wp-content\/uploads\/2010\/10\/UnloadProject.jpg 599w, https:\/\/mohamedradwan.com\/wp-content\/uploads\/2010\/10\/UnloadProject-284x300.jpg 284w\" sizes=\"(max-width: 599px) 100vw, 599px\" \/><figcaption id=\"caption-attachment-7273\" class=\"wp-caption-text\">How to unload project<\/figcaption><\/figure><\/li>\n<\/ul>\n<ul>\n<li>Right click on the project and click edit\n<p><figure id=\"attachment_7272\" aria-describedby=\"caption-attachment-7272\" style=\"width: 586px\" class=\"wp-caption alignnone\"><img loading=\"lazy\" decoding=\"async\" class=\"size-full wp-image-7272\" src=\"https:\/\/mohamedradwan.com\/wp-content\/uploads\/2010\/10\/EditProject.jpg\" alt=\"How to edit project file\" width=\"586\" height=\"300\" srcset=\"https:\/\/mohamedradwan.com\/wp-content\/uploads\/2010\/10\/EditProject.jpg 586w, https:\/\/mohamedradwan.com\/wp-content\/uploads\/2010\/10\/EditProject-300x154.jpg 300w\" sizes=\"(max-width: 586px) 100vw, 586px\" \/><figcaption id=\"caption-attachment-7272\" class=\"wp-caption-text\">How to edit project file<\/figcaption><\/figure><\/li>\n<\/ul>\n<p>Minimum all the sub elements so you can see the whole file<\/p>\n<p>Start add the following inside ItemGroup element<\/p>\n<p>[sourcecode language=&#8221;xml&#8221;] &lt;Files Include=&#8221;C:SQLQuery1.sql&#8221;\/&gt;[\/sourcecode]<\/p>\n<ul>\n<li>Import ExtensionPack tasks, if it in the default place you just write[sourcecode language=&#8221;xml&#8221;] &lt;Import Project=&#8221;$(MSBuildExtensionsPath)ExtensionPack4.0MSBuild.ExtensionPack.tasks&#8221;\/&gt;[\/sourcecode]But if it&#8217;s not in the default you have to import it with the full path\n<p>[sourcecode language=&#8221;xml&#8221;]&lt;Import Project=&#8221;C:Program FilesMSBuildExtensionPack4.0MSBuild.ExtensionPack.tasks&#8221;\/&gt; [\/sourcecode]<\/li>\n<\/ul>\n<ul>\n<li>Write a target element or just uncomment the commented target &#8220;before build or after build&#8221;<\/li>\n<\/ul>\n<ul>\n<li>Put your task between the target and use the task parameters as in the help file and the example, it&#8217;s better to review the help file because some parameters are required and some are optional, so the final project file will be like the following\n<p><figure id=\"attachment_7274\" aria-describedby=\"caption-attachment-7274\" style=\"width: 921px\" class=\"wp-caption alignnone\"><img loading=\"lazy\" decoding=\"async\" class=\"size-full wp-image-7274\" src=\"https:\/\/mohamedradwan.com\/wp-content\/uploads\/2010\/10\/csprojFile.jpg\" alt=\"Project file from inside\" width=\"921\" height=\"542\" srcset=\"https:\/\/mohamedradwan.com\/wp-content\/uploads\/2010\/10\/csprojFile.jpg 921w, https:\/\/mohamedradwan.com\/wp-content\/uploads\/2010\/10\/csprojFile-300x177.jpg 300w, https:\/\/mohamedradwan.com\/wp-content\/uploads\/2010\/10\/csprojFile-768x452.jpg 768w\" sizes=\"(max-width: 921px) 100vw, 921px\" \/><figcaption id=\"caption-attachment-7274\" class=\"wp-caption-text\">Project file from inside<\/figcaption><\/figure><\/li>\n<\/ul>\n<ul>\n<li>Build the application, you should see pop-up window and your database will be affected.<\/li>\n<\/ul>\n<ul>\n<li>You can download the project from <a title=\"MSBuildExtentionExample\" href=\"http:\/\/cid-4bcaa16d27b46600.office.live.com\/self.aspx\/.Public\/Blog%20New\/MSBuild\/MSBuildExtention\/MSBuildExtenstionPack.zip\" target=\"_blank\">here<\/a><\/li>\n<\/ul>\n<p>Have fun \ud83d\ude42<\/p>\n","protected":false},"excerpt":{"rendered":"<p>I am now interested of streamline the building and the &hellip;<\/p>\n<p class=\"read-more\"> <a class=\"ast-button\" href=\"https:\/\/mohamedradwan.com\/2010\/10\/09\/msbuildextensionpack-how-to\/\"> <span class=\"screen-reader-text\">MSBuildExtensionPack how to?<\/span> Read More<\/a><\/p>\n","protected":false},"author":2,"featured_media":7273,"comment_status":"open","ping_status":"open","sticky":false,"template":"","format":"standard","meta":{"site-sidebar-layout":"default","site-content-layout":"default","ast-global-header-display":"","ast-banner-title-visibility":"","ast-main-header-display":"","ast-hfb-above-header-display":"","ast-hfb-below-header-display":"","ast-hfb-mobile-header-display":"","site-post-title":"","ast-breadcrumbs-content":"","ast-featured-img":"","footer-sml-layout":"","theme-transparent-header-meta":"","adv-header-id-meta":"","stick-header-meta":"","header-above-stick-meta":"","header-main-stick-meta":"","header-below-stick-meta":"","footnotes":""},"categories":[16,28],"tags":[],"_links":{"self":[{"href":"https:\/\/mohamedradwan.com\/wp-json\/wp\/v2\/posts\/590"}],"collection":[{"href":"https:\/\/mohamedradwan.com\/wp-json\/wp\/v2\/posts"}],"about":[{"href":"https:\/\/mohamedradwan.com\/wp-json\/wp\/v2\/types\/post"}],"author":[{"embeddable":true,"href":"https:\/\/mohamedradwan.com\/wp-json\/wp\/v2\/users\/2"}],"replies":[{"embeddable":true,"href":"https:\/\/mohamedradwan.com\/wp-json\/wp\/v2\/comments?post=590"}],"version-history":[{"count":2,"href":"https:\/\/mohamedradwan.com\/wp-json\/wp\/v2\/posts\/590\/revisions"}],"predecessor-version":[{"id":7276,"href":"https:\/\/mohamedradwan.com\/wp-json\/wp\/v2\/posts\/590\/revisions\/7276"}],"wp:featuredmedia":[{"embeddable":true,"href":"https:\/\/mohamedradwan.com\/wp-json\/wp\/v2\/media\/7273"}],"wp:attachment":[{"href":"https:\/\/mohamedradwan.com\/wp-json\/wp\/v2\/media?parent=590"}],"wp:term":[{"taxonomy":"category","embeddable":true,"href":"https:\/\/mohamedradwan.com\/wp-json\/wp\/v2\/categories?post=590"},{"taxonomy":"post_tag","embeddable":true,"href":"https:\/\/mohamedradwan.com\/wp-json\/wp\/v2\/tags?post=590"}],"curies":[{"name":"wp","href":"https:\/\/api.w.org\/{rel}","templated":true}]}}