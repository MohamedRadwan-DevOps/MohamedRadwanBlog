{"id":596,"date":"2010-10-23T00:54:57","date_gmt":"2010-10-23T00:54:57","guid":{"rendered":"https:\/\/mohamedradwan.com\/?p=293"},"modified":"2017-08-30T13:59:21","modified_gmt":"2017-08-30T13:59:21","slug":"create-msbuild-custom-task","status":"publish","type":"post","link":"https:\/\/mohamedradwan.com\/2010\/10\/23\/create-msbuild-custom-task\/","title":{"rendered":"Create MSBuild Custom Task"},"content":{"rendered":"<hr \/>\n<p>Hello,<\/p>\n<p>I Will show you how to create MSBuild custom task I know you will find many examples on the internet but if you just try most of them most properly it will not work, so I decide to post article that describe it in very simple way with source code of the success project. If you want to see a tutorial on MSBuild you can visit the following link <a title=\"MSBuild Tutorial\" href=\"https:\/\/mohamedradwan.com\/2010\/10\/15\/msbuild-tutorial\/\" target=\"_blank\">click-here<\/a><\/p>\n<p>First part<\/p>\n<ul>\n<li>Create a class library project that will contain all your custom task classes<\/li>\n<li>Reference both Microsoft.Build.Framework and Microsoft.Build.Utilities<\/li>\n<li>Create a new class and name it MyTask inherit from Class Task, and override the Execute method<\/li>\n<li>Call Log.LogMessage to output a message during the build and give it the property of your class<\/li>\n<\/ul>\n<p>[sourcecode language=&#8221;csharp&#8221;]<br \/>\nusing System;<br \/>\nusing Microsoft.Build.Framework;<br \/>\nusing Microsoft.Build.Utilities;<\/p>\n<p>namespace CustomTask<br \/>\n{<br \/>\npublic class MyTask : Task<br \/>\n{<br \/>\npublic string MyProperty { get; set; }<\/p>\n<p>public override bool Execute()<br \/>\n{<br \/>\n\/\/ Log a high-importance comment<br \/>\nLog.LogMessage(MessageImportance.High, &#8220;The task was passed &#8220;&#8221; + MyProperty + &#8220;&#8221;.&#8221;);<br \/>\nreturn true;<br \/>\n}<br \/>\n}<br \/>\n}<br \/>\n[\/sourcecode]<\/p>\n<p>Second part, the usage of your custom task<\/p>\n<ul>\n<li>Create any project,\u00a0 it prefers to be class library also and remove all the code between the project element<\/li>\n<li>Edit the target to be MyTarget<\/li>\n<li>Add a reference to the assembly that contain the custom task and here what cause the problem to happen, the wrong path always make problem so my advice to you that you have to know exactly how to point to specific file and what is the different between absolute and relative path, how to out from the current folder or 2 folders and so on so forth, any way you just add the reference<\/li>\n<\/ul>\n<ul>\n<li>Add new Target called MyTarget and start using the task<\/li>\n<\/ul>\n<figure id=\"attachment_7242\" aria-describedby=\"caption-attachment-7242\" style=\"width: 744px\" class=\"wp-caption alignnone\"><a href=\"https:\/\/mohamedradwan.com\/wp-content\/uploads\/2010\/10\/ProjectFile.png\"><img loading=\"lazy\" decoding=\"async\" class=\" wp-image-7242\" src=\"https:\/\/mohamedradwan.com\/wp-content\/uploads\/2010\/10\/ProjectFile.png\" alt=\"Use your custom task\" width=\"744\" height=\"229\" srcset=\"https:\/\/mohamedradwan.com\/wp-content\/uploads\/2010\/10\/ProjectFile.png 874w, https:\/\/mohamedradwan.com\/wp-content\/uploads\/2010\/10\/ProjectFile-300x92.png 300w, https:\/\/mohamedradwan.com\/wp-content\/uploads\/2010\/10\/ProjectFile-768x236.png 768w\" sizes=\"(max-width: 744px) 100vw, 744px\" \/><\/a><figcaption id=\"caption-attachment-7242\" class=\"wp-caption-text\">Use your custom task<\/figcaption><\/figure>\n<ul>\n<li>Open Visual studio CMD and go the project file path and run MSBuild and that&#8217;s it<\/li>\n<\/ul>\n<figure id=\"attachment_7241\" aria-describedby=\"caption-attachment-7241\" style=\"width: 672px\" class=\"wp-caption alignnone\"><a href=\"https:\/\/mohamedradwan.com\/wp-content\/uploads\/2010\/10\/CMD.png\"><img loading=\"lazy\" decoding=\"async\" class=\"size-full wp-image-7241\" src=\"https:\/\/mohamedradwan.com\/wp-content\/uploads\/2010\/10\/CMD.png\" alt=\"Run MSBuild for the project\" width=\"672\" height=\"344\" srcset=\"https:\/\/mohamedradwan.com\/wp-content\/uploads\/2010\/10\/CMD.png 672w, https:\/\/mohamedradwan.com\/wp-content\/uploads\/2010\/10\/CMD-300x154.png 300w\" sizes=\"(max-width: 672px) 100vw, 672px\" \/><\/a><figcaption id=\"caption-attachment-7241\" class=\"wp-caption-text\">Run MSBuild for the project<\/figcaption><\/figure>\n<p>To download the project just click <a title=\"CustomTask Project\" href=\"http:\/\/cid-4bcaa16d27b46600.office.live.com\/self.aspx\/Blog%20New%20Docs%20only\/UseTask.zip\" target=\"_blank\">here<\/a><\/p>\n<p>You can find also the link on the MSDN that describe the custom task <a title=\"MSDN\" href=\"http:\/\/msdn.microsoft.com\/en-us\/library\/t9883dzc.aspx\" target=\"_blank\">here<\/a><\/p>\n<p>Note:<br \/>\nMost of problem happen because the path of the dll of the custom task so if you have a problem creating your own you just use absolute path to make sure the example work and then fix the absolute path with relative path<\/p>\n<p>I hope you like it.<\/p>\n","protected":false},"excerpt":{"rendered":"<p>Hello, I Will show you how to create MSBuild custom &hellip;<\/p>\n<p class=\"read-more\"> <a class=\"ast-button\" href=\"https:\/\/mohamedradwan.com\/2010\/10\/23\/create-msbuild-custom-task\/\"> <span class=\"screen-reader-text\">Create MSBuild Custom Task<\/span> Read More<\/a><\/p>\n","protected":false},"author":2,"featured_media":7242,"comment_status":"open","ping_status":"open","sticky":false,"template":"","format":"standard","meta":{"site-sidebar-layout":"default","site-content-layout":"default","ast-global-header-display":"","ast-banner-title-visibility":"","ast-main-header-display":"","ast-hfb-above-header-display":"","ast-hfb-below-header-display":"","ast-hfb-mobile-header-display":"","site-post-title":"","ast-breadcrumbs-content":"","ast-featured-img":"","footer-sml-layout":"","theme-transparent-header-meta":"","adv-header-id-meta":"","stick-header-meta":"","header-above-stick-meta":"","header-main-stick-meta":"","header-below-stick-meta":"","footnotes":""},"categories":[16,28],"tags":[],"_links":{"self":[{"href":"https:\/\/mohamedradwan.com\/wp-json\/wp\/v2\/posts\/596"}],"collection":[{"href":"https:\/\/mohamedradwan.com\/wp-json\/wp\/v2\/posts"}],"about":[{"href":"https:\/\/mohamedradwan.com\/wp-json\/wp\/v2\/types\/post"}],"author":[{"embeddable":true,"href":"https:\/\/mohamedradwan.com\/wp-json\/wp\/v2\/users\/2"}],"replies":[{"embeddable":true,"href":"https:\/\/mohamedradwan.com\/wp-json\/wp\/v2\/comments?post=596"}],"version-history":[{"count":2,"href":"https:\/\/mohamedradwan.com\/wp-json\/wp\/v2\/posts\/596\/revisions"}],"predecessor-version":[{"id":7244,"href":"https:\/\/mohamedradwan.com\/wp-json\/wp\/v2\/posts\/596\/revisions\/7244"}],"wp:featuredmedia":[{"embeddable":true,"href":"https:\/\/mohamedradwan.com\/wp-json\/wp\/v2\/media\/7242"}],"wp:attachment":[{"href":"https:\/\/mohamedradwan.com\/wp-json\/wp\/v2\/media?parent=596"}],"wp:term":[{"taxonomy":"category","embeddable":true,"href":"https:\/\/mohamedradwan.com\/wp-json\/wp\/v2\/categories?post=596"},{"taxonomy":"post_tag","embeddable":true,"href":"https:\/\/mohamedradwan.com\/wp-json\/wp\/v2\/tags?post=596"}],"curies":[{"name":"wp","href":"https:\/\/api.w.org\/{rel}","templated":true}]}}